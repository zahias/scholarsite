import{c as F,p as le,C as L,k as B,B as A,q as Z,I as xe,a0 as he,a2 as ue,t as pe,h as ee,x as be,y as fe}from"./index-BVqimLhm.js";import{j as e,u as U}from"./vendor-query-CD7Z7DR7.js";import{r as m,R as I}from"./vendor-react-DHpf67ko.js";import{S as $}from"./skeleton-CsLyhTnv.js";import{A as ge}from"./award-B8CT3Z3r.js";import{S as V,a as _,b as D,c as R,d as k}from"./select-CL0jWh7P.js";import{S as je}from"./separator-Ml9BTPnQ.js";import{D as ve,a as ye,b as Ne,c as we,d as ke,i as Ce}from"./dialog-C8fiLdD3.js";import{S as te}from"./star-P7Ey3Fat.js";import{F as q}from"./file-text-faVa3UG5.js";import{E as Se}from"./external-link-wvgwl-pf.js";import{D as Oe}from"./download-BtEd9by0.js";import{D as Pe}from"./database-e6bvwuSL.js";import{U as Ee}from"./user-BicejYAW.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=F("FileJson",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=F("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=F("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=F("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=F("Quote",[["path",{d:"M16 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"rib7q0"}],["path",{d:"M5 3a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2 1 1 0 0 1 1 1v1a2 2 0 0 1-2 2 1 1 0 0 0-1 1v2a1 1 0 0 0 1 1 6 6 0 0 0 6-6V5a2 2 0 0 0-2-2z",key:"1ymkrd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=F("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);function at({researcherName:t="Researcher"}){const[a,r]=m.useState("overview");m.useEffect(()=>{const o=()=>{const d=["overview","insights","publications"],h=window.scrollY+window.innerHeight/3;for(const c of d){const p=document.getElementById(c);if(p){const{offsetTop:j,offsetHeight:x}=p;if(h>=j&&h<j+x){r(c);break}}}};return window.addEventListener("scroll",o),o(),()=>window.removeEventListener("scroll",o)},[]);const l=o=>{const d=document.getElementById(o);d&&d.scrollIntoView({behavior:"smooth"})},n=[{id:"overview",label:"Overview"},{id:"insights",label:"Insights"},{id:"publications",label:"Publications"}];return e.jsx("nav",{className:"sticky top-0 z-50 bg-white dark:bg-slate-900 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800 shadow-sm","aria-label":"Profile navigation",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex justify-between h-16",children:[e.jsx("div",{className:"flex items-center",children:e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-white",children:t})}),e.jsx("div",{className:"hidden md:flex items-center space-x-8",children:n.map(o=>e.jsxs("button",{onClick:()=>l(o.id),className:`relative py-2 transition-colors ${a===o.id?"text-slate-900 dark:text-white font-medium":"text-slate-600 dark:text-slate-300 hover:text-slate-900 dark:hover:text-white"}`,"data-testid":`nav-${o.id}`,children:[o.label,a===o.id&&e.jsx("span",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary dark:bg-white rounded-full"})]},o.id))})]})})})}function $e({end:t,duration:a=2e3,className:r="",formatter:l=n=>n.toLocaleString()}){const[n,o]=m.useState(0),[d,h]=m.useState(!1),[c,p]=m.useState(t),j=m.useRef(null),x=typeof window<"u"&&window.matchMedia("(prefers-reduced-motion: reduce)").matches;return m.useEffect(()=>{t!==c&&t>0&&(h(!1),p(t))},[t,c]),m.useEffect(()=>{if(!t||isNaN(t)||t===0){o(t||0);return}if(d)return;if(x){o(t),h(!0);return}const b=new IntersectionObserver(g=>{if(g[0].isIntersecting){h(!0);const C=Date.now(),S=0,P=t,f=()=>{const w=Date.now()-C,T=Math.min(w/a,1),E=1-Math.pow(1-T,3),z=Math.floor(S+(P-S)*E);o(z),T<1?requestAnimationFrame(f):o(P)};requestAnimationFrame(f),b.disconnect()}},{threshold:.1});return j.current&&b.observe(j.current),()=>b.disconnect()},[t,a,d,x]),e.jsx("span",{ref:j,className:r,children:l(n)})}function rt({openalexId:t}){const{data:a,isLoading:r}=U({queryKey:[`/api/researcher/${t}/data`],retry:!1});if(r)return e.jsx("section",{className:"py-8 -mt-6",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((c,p)=>e.jsx($,{className:"h-24 rounded-xl"},p))})})});if(!(a!=null&&a.researcher))return null;const l=a==null?void 0:a.researcher,n=(l==null?void 0:l.summary_stats)??{h_index:0,i10_index:0},o=(l==null?void 0:l.works_count)??0,d=(l==null?void 0:l.cited_by_count)??0,h=[{label:"Publications",value:o,icon:le,color:"text-blue-600 dark:text-blue-400",bgColor:"bg-blue-50 dark:bg-blue-950/30",borderColor:"border-blue-100 dark:border-blue-900/30"},{label:"Citations",value:d,icon:ie,color:"text-amber-600 dark:text-amber-400",bgColor:"bg-amber-50 dark:bg-amber-950/30",borderColor:"border-amber-100 dark:border-amber-900/30"},{label:"h-index",value:n.h_index??0,icon:Te,color:"text-emerald-600 dark:text-emerald-400",bgColor:"bg-emerald-50 dark:bg-emerald-950/30",borderColor:"border-emerald-100 dark:border-emerald-900/30"},{label:"i10-index",value:n.i10_index??0,icon:ge,color:"text-purple-600 dark:text-purple-400",bgColor:"bg-purple-50 dark:bg-purple-950/30",borderColor:"border-purple-100 dark:border-purple-900/30"}];return e.jsx("section",{className:"py-8 -mt-6 md:-mt-8 bg-academic-motif relative","data-testid":"section-stats",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4",children:h.map(c=>e.jsxs("div",{className:"bg-white/70 dark:bg-midnight/30 backdrop-blur-xl shadow-xl border-platinum dark:border-white/20 border rounded-xl p-6 text-center transition-all hover:-translate-y-1 hover:shadow-2xl",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-xl bg-muted/50 dark:bg-muted/20 mb-4",children:e.jsx(c.icon,{className:"w-6 h-6 text-midnight dark:text-white"})}),e.jsx("div",{className:"text-3xl md:text-4xl font-serif font-bold text-midnight dark:text-white","data-testid":`stat-${c.label.toLowerCase().replace("-","-")}`,children:e.jsx($e,{end:c.value})}),e.jsx("div",{className:"text-sm text-muted-foreground font-medium mt-2",children:c.label})]},c.label))})})})}function se({icon:t,title:a,description:r,action:l,className:n="","data-testid":o}){return e.jsx("div",{"data-testid":o,className:n,children:e.jsx(L,{children:e.jsxs(B,{className:"p-8 text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-12 w-12 items-center justify-center rounded-full bg-muted",children:e.jsx(t,{className:"h-6 w-6 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:a}),e.jsx("p",{className:"text-muted-foreground text-sm max-w-sm mx-auto",children:r}),l&&e.jsx(A,{variant:"outline",onClick:l.onClick,className:"mt-4",children:l.label})]})})})}function lt({openalexId:t,inline:a=!1}){const[r,l]=m.useState(""),[n,o]=m.useState("year"),[d,h]=m.useState("desc"),[c,p]=m.useState("all"),[j,x]=m.useState("all"),[b,g]=m.useState("all"),[C,S]=m.useState(!1),P=10,[f,y]=m.useState(!1),w=s=>{window.location.href=`/api/researcher/${t}/export-bibliography?format=${s}`,y(!1)},T=()=>e.jsxs(ve,{open:f,onOpenChange:y,children:[e.jsx(ye,{asChild:!0,children:e.jsxs(A,{variant:"outline","data-testid":"button-export-bibliography",children:[e.jsx(Oe,{className:"w-4 h-4 mr-2"}),"Export Bibliography"]})}),e.jsxs(Ne,{className:"sm:max-w-md",children:[e.jsxs(we,{children:[e.jsx(ke,{children:"Export Bibliography"}),e.jsxs(Ce,{children:["Choose your preferred format to download all ",v.length," publications."]})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-3 py-4",children:[e.jsxs(A,{onClick:()=>w("bibtex"),variant:"outline",className:"justify-start h-auto py-4","data-testid":"button-export-bibtex",children:[e.jsx(q,{className:"w-5 h-5 mr-3 text-blue-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"BibTeX (.bib)"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"LaTeX citation format"})]})]}),e.jsxs(A,{onClick:()=>w("ris"),variant:"outline",className:"justify-start h-auto py-4","data-testid":"button-export-ris",children:[e.jsx(Pe,{className:"w-5 h-5 mr-3 text-green-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"RIS (.ris)"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Research Information Systems format"})]})]}),e.jsxs(A,{onClick:()=>w("csv"),variant:"outline",className:"justify-start h-auto py-4","data-testid":"button-export-csv",children:[e.jsx(Me,{className:"w-5 h-5 mr-3 text-purple-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"CSV (.csv)"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Spreadsheet format"})]})]}),e.jsxs(A,{onClick:()=>w("json"),variant:"outline",className:"justify-start h-auto py-4","data-testid":"button-export-json",children:[e.jsx(Ae,{className:"w-5 h-5 mr-3 text-orange-600"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold",children:"JSON (.json)"}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Structured data format"})]})]})]})]})]}),{data:E,isLoading:z}=U({queryKey:[`/api/researcher/${t}/data`],retry:!1}),v=(E==null?void 0:E.publications)||[],G=m.useMemo(()=>{const s=v.filter(i=>i.isFeatured);return s.length>0?s:[...v].sort((i,u)=>(u.citationCount||0)-(i.citationCount||0)).slice(0,3)},[v]),M=m.useMemo(()=>{let s=[...v];if(r){const i=r.toLowerCase();s=s.filter(u=>{var N,O,J,X;return((N=u.title)==null?void 0:N.toLowerCase().includes(i))||((O=u.authorNames)==null?void 0:O.toLowerCase().includes(i))||((J=u.journal)==null?void 0:J.toLowerCase().includes(i))||((X=u.topics)==null?void 0:X.some(me=>me.toLowerCase().includes(i)))})}return c&&c!=="all"&&(s=s.filter(i=>{var u;return((u=i.publicationYear)==null?void 0:u.toString())===c})),j!=="all"&&(s=s.filter(i=>j==="open"?i.isOpenAccess:!i.isOpenAccess)),b&&b!=="all"&&(s=s.filter(i=>i.publicationType===b)),s.sort((i,u)=>{let N,O;switch(n){case"year":N=i.publicationYear||0,O=u.publicationYear||0;break;case"citations":N=i.citationCount||0,O=u.citationCount||0;break;case"title":N=i.title||"",O=u.title||"";break;default:return 0}return n==="title"?d==="desc"?O.localeCompare(N):N.localeCompare(O):d==="desc"?O-N:N-O}),s},[v,r,n,d,c,j,b]),ce=m.useMemo(()=>{const s=v.map(i=>i.publicationYear).filter(i=>i).sort((i,u)=>u-i);return Array.from(new Set(s))},[v]),de=m.useMemo(()=>{const s=v.map(i=>i.publicationType).filter(i=>i);return Array.from(new Set(s))},[v]),K=C?M:M.slice(0,P);if(z)return e.jsx("section",{id:"publications",className:"py-16",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"text-center mb-12",children:[e.jsx($,{className:"h-8 w-48 mx-auto mb-4"}),e.jsx($,{className:"h-4 w-96 mx-auto"})]}),e.jsx("div",{className:"space-y-6",children:[...Array(3)].map((s,i)=>e.jsx(L,{children:e.jsxs(B,{className:"p-6",children:[e.jsx($,{className:"h-6 w-full mb-2"}),e.jsx($,{className:"h-4 w-64 mb-3"}),e.jsx($,{className:"h-4 w-32"})]})},i))})]})});const Q=e.jsxs(e.Fragment,{children:[!a&&e.jsx("div",{className:"text-center mb-6 md:mb-8",children:e.jsxs("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-serif font-bold text-midnight dark:text-white mb-2",children:["Publications",v.length>0&&e.jsx(Z,{variant:"secondary",className:"ml-2 text-xs md:text-sm",children:v.length})]})}),G.length>0&&e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-xl font-serif font-bold text-midnight dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(te,{className:"w-5 h-5 text-warm fill-warm"}),"Featured Works"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:G.slice(0,3).map((s,i)=>{var u;return e.jsx(L,{className:"bg-white/80 dark:bg-midnight/40 backdrop-blur-xl border-l-4 border-l-warm border-platinum dark:border-white/20 shadow-lg hover:-translate-y-1 hover:shadow-2xl transition-all","data-testid":`card-featured-${i}`,children:e.jsxs(B,{className:"p-4",children:[e.jsx("h4",{className:"font-serif font-bold text-base text-midnight dark:text-white line-clamp-2 mb-2",children:s.title}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-1 mb-2",children:s.authorNames}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:s.publicationYear}),e.jsxs("span",{className:"font-medium text-amber-600 dark:text-amber-400",children:[((u=s.citationCount)==null?void 0:u.toLocaleString())||0," citations"]})]}),s.doi&&e.jsx("a",{href:`https://doi.org/${s.doi}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-xs text-primary hover:underline mt-2",children:"View â†’"})]})},s.id)})})]}),v.length>0&&e.jsx(L,{className:"mb-4 md:mb-8",children:e.jsxs(B,{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-3 md:gap-4 items-end",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Search Publications"}),e.jsx(xe,{placeholder:"Search by title, author, journal, or topic...",value:r,onChange:s=>l(s.target.value),className:"w-full","data-testid":"input-search-publications"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Sort By"}),e.jsxs(V,{value:n,onValueChange:s=>o(s),children:[e.jsx(_,{"data-testid":"select-sort-by",children:e.jsx(D,{})}),e.jsxs(R,{children:[e.jsx(k,{value:"year",children:"Publication Year"}),e.jsx(k,{value:"citations",children:"Citation Count"}),e.jsx(k,{value:"title",children:"Title"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Order"}),e.jsxs(V,{value:d,onValueChange:s=>h(s),children:[e.jsx(_,{"data-testid":"select-sort-order",children:e.jsx(D,{})}),e.jsxs(R,{children:[e.jsx(k,{value:"desc",children:"Descending"}),e.jsx(k,{value:"asc",children:"Ascending"})]})]})]}),e.jsx("div",{children:e.jsx(A,{variant:"outline",onClick:()=>{l(""),p("all"),x("all"),g("all"),o("year"),h("desc")},className:"w-full","data-testid":"button-clear-filters",children:"Clear Filters"})})]}),e.jsx(je,{className:"my-4"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Publication Year"}),e.jsxs(V,{value:c,onValueChange:p,children:[e.jsx(_,{"data-testid":"select-year-filter",children:e.jsx(D,{placeholder:"All years"})}),e.jsxs(R,{children:[e.jsx(k,{value:"all",children:"All years"}),ce.map(s=>e.jsx(k,{value:s.toString(),children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Publication Type"}),e.jsxs(V,{value:b,onValueChange:g,children:[e.jsx(_,{"data-testid":"select-type-filter",children:e.jsx(D,{placeholder:"All types"})}),e.jsxs(R,{children:[e.jsx(k,{value:"all",children:"All types"}),de.map(s=>e.jsx(k,{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Access Type"}),e.jsxs(V,{value:j,onValueChange:s=>x(s),children:[e.jsx(_,{"data-testid":"select-access-filter",children:e.jsx(D,{})}),e.jsxs(R,{children:[e.jsx(k,{value:"all",children:"All Types"}),e.jsx(k,{value:"open",children:"Open Access"}),e.jsx(k,{value:"closed",children:"Closed Access"})]})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",K.length," of ",M.length]})})]})]})}),v.length===0?e.jsx(se,{icon:q,title:"No Publications",description:"No publications available. Please sync your data in the admin panel."}):M.length===0?e.jsx(se,{icon:he,title:"No Results",description:"No publications match your current filters.",action:{label:"Clear Filters",onClick:()=>{l(""),p("all"),x("all"),g("all")}}}):e.jsx("div",{className:"space-y-6",children:K.map((s,i)=>e.jsx(L,{className:`bg-white/70 dark:bg-midnight/30 backdrop-blur-xl shadow-lg border-platinum dark:border-white/20 hover:-translate-y-1 hover:shadow-2xl transition-all ${s.isFeatured?"border-l-4 border-l-warm":"border-l-4 border-l-sage"}`,"data-testid":`card-publication-${i}`,children:e.jsx(B,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[s.isFeatured&&e.jsx(te,{className:"w-5 h-5 text-yellow-500 fill-yellow-500 flex-shrink-0 mt-1"}),e.jsx("h3",{className:"font-serif font-bold text-xl text-midnight dark:text-white","data-testid":`text-publication-title-${i}`,children:s.title})]}),e.jsx("p",{className:"text-muted-foreground text-sm mb-3","data-testid":`text-publication-authors-${i}`,children:s.authorNames}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4 mb-3",children:[s.isFeatured&&e.jsx(Z,{className:"bg-yellow-100 text-yellow-800 border-yellow-300",children:"Featured"}),s.journal&&e.jsx("span",{className:"text-sm text-muted-foreground","data-testid":`text-publication-journal-${i}`,children:s.journal}),s.publicationYear&&e.jsx("span",{className:"text-sm text-muted-foreground","data-testid":`text-publication-year-${i}`,children:s.publicationYear}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ie,{className:"w-3.5 h-3.5 text-accent mr-1"}),e.jsxs("span",{className:"text-sm font-medium text-accent","data-testid":`text-publication-citations-${i}`,children:[s.citationCount," citations"]})]})]}),s.topics&&s.topics.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.topics.slice(0,3).map((u,N)=>e.jsx("span",{className:"bg-primary/10 text-primary text-xs px-2 py-1 rounded","data-testid":`tag-topic-${i}-${N}`,children:u},N))})]}),e.jsxs("div",{className:"mt-4 lg:mt-0 lg:ml-6 flex flex-col items-end space-y-2",children:[s.pdfUrl&&e.jsxs("a",{href:s.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 text-red-600 hover:text-red-700 text-sm font-medium","data-testid":`link-publication-pdf-${i}`,children:[e.jsx(q,{className:"w-4 h-4"}),"Download PDF"]}),s.doi&&e.jsxs("a",{href:`https://doi.org/${s.doi}`,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:text-primary/80 text-sm font-medium","data-testid":`link-publication-doi-${i}`,children:[e.jsx(Se,{className:"w-3.5 h-3.5 mr-1 inline"}),"View Publication"]}),s.isOpenAccess&&e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded","data-testid":`badge-open-access-${i}`,children:"Open Access"})]})]})})},s.id))}),M.length>P&&!C&&e.jsxs("div",{className:"text-center mt-12",children:[e.jsxs(A,{onClick:()=>S(!0),className:"bg-primary text-primary-foreground hover:bg-primary/90 mr-4","data-testid":"button-view-all-publications",children:["View All ",M.length," Publications"]}),e.jsx(T,{})]}),C&&M.length>P&&e.jsxs("div",{className:"text-center mt-12",children:[e.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:["Showing all ",M.length," publications"]}),e.jsx(A,{variant:"outline",onClick:()=>{var s;S(!1),(s=document.getElementById("publications"))==null||s.scrollIntoView({behavior:"smooth"})},className:"mr-4","data-testid":"button-show-less",children:"Show Less"}),e.jsx(T,{})]})]});return a?e.jsx("div",{"data-testid":"section-publications",children:Q}):e.jsx("section",{id:"publications",className:"py-8 md:py-16 bg-academic-motif relative","data-testid":"section-publications",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:Q})})}function it({openalexId:t,inline:a=!1}){const{data:r,isLoading:l}=U({queryKey:[`/api/researcher/${t}/data`],retry:!1}),{groupedTopics:n,allTopics:o}=m.useMemo(()=>{const x=(r==null?void 0:r.topics)||[];if(x.length===0)return{groupedTopics:{},allTopics:[]};const b=Math.max(...x.map(f=>f.count)),g=Math.min(...x.map(f=>f.count)),C=x.map(f=>{const y=b===g?1:(f.count-g)/(b-g),w=Math.ceil(y*4)+1;return{...f,size:w}}),S={};C.forEach(f=>{const y=f.domain||"Other";S[y]||(S[y]=[]),S[y].push(f)});const P={};return Object.entries(S).sort((f,y)=>{const w=f[1].reduce((E,z)=>E+z.count,0);return y[1].reduce((E,z)=>E+z.count,0)-w}).forEach(([f,y])=>{P[f]=y.sort((w,T)=>T.count-w.count)}),{groupedTopics:P,allTopics:C}},[r]);if(l)return e.jsxs("div",{className:"space-y-4",children:[e.jsx($,{className:"h-6 w-48 mx-auto"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-2",children:[...Array(12)].map((x,b)=>e.jsx($,{className:"h-8 w-24 rounded-full"},b))})]});const d=(r==null?void 0:r.topics)||[],h={1:"text-xs px-2 py-0.5",2:"text-xs px-2.5 py-1",3:"text-sm px-3 py-1",4:"text-sm px-3 py-1.5 font-medium",5:"text-base px-4 py-1.5 font-semibold"},c={"Physical Sciences":"bg-blue-100 text-blue-800 hover:bg-blue-200 dark:bg-blue-900/30 dark:text-blue-300","Life Sciences":"bg-green-100 text-green-800 hover:bg-green-200 dark:bg-green-900/30 dark:text-green-300","Social Sciences":"bg-purple-100 text-purple-800 hover:bg-purple-200 dark:bg-purple-900/30 dark:text-purple-300","Health Sciences":"bg-red-100 text-red-800 hover:bg-red-200 dark:bg-red-900/30 dark:text-red-300",Engineering:"bg-amber-100 text-amber-800 hover:bg-amber-200 dark:bg-amber-900/30 dark:text-amber-300","Arts & Humanities":"bg-pink-100 text-pink-800 hover:bg-pink-200 dark:bg-pink-900/30 dark:text-pink-300",Other:"bg-gray-100 text-gray-800 hover:bg-gray-200 dark:bg-gray-800/50 dark:text-gray-300"},p=x=>c[x]||c.Other,j=e.jsxs(e.Fragment,{children:[!a&&e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-1",children:"Research Areas"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[d.length," topics across ",Object.keys(n).length," domains"]})]}),d.length===0?e.jsx(L,{children:e.jsxs(B,{className:"p-6 text-center",children:[e.jsx("div",{className:"text-4xl mb-3",children:"ðŸ”¬"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Research Topics"}),e.jsx("p",{className:"text-muted-foreground text-sm",children:"Topics will appear once publication data is synchronized."})]})}):e.jsx("div",{className:"space-y-6",children:Object.entries(n).map(([x,b])=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[e.jsx("span",{className:`w-2 h-2 rounded-full ${p(x).split(" ")[0]}`}),x,e.jsxs("span",{className:"text-xs",children:["(",b.length,")"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[b.slice(0,8).map((g,C)=>e.jsxs("span",{className:`inline-flex items-center rounded-full transition-colors cursor-default ${h[g.size]} ${p(x)}`,title:`${g.count} publications â€¢ ${g.subfield||g.field||x}`,"data-testid":`tag-topic-${C}`,children:[g.displayName,e.jsx("span",{className:"ml-1.5 opacity-60 text-[0.7em]",children:g.count})]},g.id||C)),b.length>8&&e.jsxs("span",{className:"inline-flex items-center text-xs text-muted-foreground px-2 py-1",children:["+",b.length-8," more"]})]})]},x))})]});return a?e.jsx("div",{"data-testid":"section-research-topics",children:j}):e.jsx("section",{id:"research",className:"py-6","data-testid":"section-research-topics",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:j})})}function nt(){const[t,a]=m.useState("overview");m.useEffect(()=>{const n=()=>{const o=["overview","analytics","research","publications"],d=window.scrollY+window.innerHeight/2;for(const h of o){const c=document.getElementById(h);if(c){const{offsetTop:p,offsetHeight:j}=c;if(d>=p&&d<p+j){a(h);break}}}};return window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)},[]);const r=n=>{const o=document.getElementById(n);o&&o.scrollIntoView({behavior:"smooth"})},l=[{id:"overview",icon:ue,label:"Overview"},{id:"analytics",icon:pe,label:"Impact"},{id:"research",icon:Ee,label:"Research"},{id:"publications",icon:le,label:"Publications"}];return e.jsx("nav",{"aria-label":"Profile sections",className:"md:hidden fixed bottom-0 left-0 right-0 bg-background/95 backdrop-blur-lg border-t border-border z-50",style:{paddingBottom:"max(env(safe-area-inset-bottom), 12px)"},children:e.jsx("div",{className:"grid grid-cols-4 gap-1 px-3 py-2",children:l.map(n=>{const o=n.icon,d=t===n.id;return e.jsxs("button",{onClick:()=>r(n.id),className:`flex flex-col items-center justify-center gap-1 min-h-[52px] py-2 px-2 rounded-xl transition-colors active:scale-95 ${d?"text-primary bg-primary/10":"text-muted-foreground hover:text-foreground active:bg-muted/50"}`,"data-testid":`nav-mobile-${n.id}`,children:[e.jsx(o,{className:"h-5 w-5"}),e.jsx("span",{className:"text-[11px] font-medium leading-tight",children:n.label})]},n.id)})})})}function ot({title:t,icon:a,children:r,defaultOpen:l=!0,mobileDefaultOpen:n,className:o,id:d,badge:h}){const[c,p]=m.useState(l);return m.useEffect(()=>{n!==void 0&&window.innerWidth<768&&p(n)},[n]),e.jsx("section",{id:d,className:ee("py-6 md:py-12 scroll-mt-20",o),children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsx("h2",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-4 md:mb-8",children:e.jsxs("button",{onClick:()=>p(!c),className:"w-full flex items-center justify-between gap-4 group cursor-pointer hover:opacity-80 transition-opacity text-left","aria-expanded":c,"aria-controls":`${d}-content`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a&&e.jsx("span",{className:"text-primary",children:a}),e.jsx("span",{children:t}),h]}),e.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[e.jsx("span",{className:"text-xs sm:text-sm hidden sm:inline font-normal",children:c?"Collapse":"Expand"}),c?e.jsx(be,{className:"w-5 h-5 transition-transform"}):e.jsx(fe,{className:"w-5 h-5 transition-transform"})]})]})}),e.jsx("div",{id:`${d}-content`,className:"grid transition-all duration-300 ease-in-out",style:{gridTemplateRows:c?"1fr":"0fr"},children:e.jsx("div",{className:ee("overflow-hidden",c?"opacity-100":"opacity-0"),style:{transition:"opacity 200ms ease-in-out"},children:r})})]})})}var ne={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ae=I.createContext&&I.createContext(ne),ze=["attr","size","title"];function Ie(t,a){if(t==null)return{};var r=Le(t,a),l,n;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(n=0;n<o.length;n++)l=o[n],!(a.indexOf(l)>=0)&&Object.prototype.propertyIsEnumerable.call(t,l)&&(r[l]=t[l])}return r}function Le(t,a){if(t==null)return{};var r={};for(var l in t)if(Object.prototype.hasOwnProperty.call(t,l)){if(a.indexOf(l)>=0)continue;r[l]=t[l]}return r}function H(){return H=Object.assign?Object.assign.bind():function(t){for(var a=1;a<arguments.length;a++){var r=arguments[a];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},H.apply(this,arguments)}function re(t,a){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(t);a&&(l=l.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),r.push.apply(r,l)}return r}function Y(t){for(var a=1;a<arguments.length;a++){var r=arguments[a]!=null?arguments[a]:{};a%2?re(Object(r),!0).forEach(function(l){Be(t,l,r[l])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):re(Object(r)).forEach(function(l){Object.defineProperty(t,l,Object.getOwnPropertyDescriptor(r,l))})}return t}function Be(t,a,r){return a=Fe(a),a in t?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r,t}function Fe(t){var a=Ve(t,"string");return typeof a=="symbol"?a:a+""}function Ve(t,a){if(typeof t!="object"||!t)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var l=r.call(t,a||"default");if(typeof l!="object")return l;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(t)}function oe(t){return t&&t.map((a,r)=>I.createElement(a.tag,Y({key:r},a.attr),oe(a.child)))}function W(t){return a=>I.createElement(_e,H({attr:Y({},t.attr)},a),oe(t.child))}function _e(t){var a=r=>{var{attr:l,size:n,title:o}=t,d=Ie(t,ze),h=n||r.size||"1em",c;return r.className&&(c=r.className),t.className&&(c=(c?c+" ":"")+t.className),I.createElement("svg",H({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,l,d,{className:c,style:Y(Y({color:t.color||r.color},r.style),t.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),o&&I.createElement("title",null,o),t.children)};return ae!==void 0?I.createElement(ae.Consumer,null,r=>a(r)):a(ne)}function ct(t){return W({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5.242 13.769L0 9.5 12 0l12 9.5-5.242 4.269C17.548 11.249 14.978 9.5 12 9.5c-2.977 0-5.548 1.748-6.758 4.269zM12 10a7 7 0 1 0 0 14 7 7 0 0 0 0-14z"},child:[]}]})(t)}function dt(t){return W({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 0C5.372 0 0 5.372 0 12s5.372 12 12 12 12-5.372 12-12S18.628 0 12 0zM7.369 4.378c.525 0 .947.431.947.947s-.422.947-.947.947a.95.95 0 0 1-.947-.947c0-.525.422-.947.947-.947zm-.722 3.038h1.444v10.041H6.647V7.416zm3.562 0h3.9c3.712 0 5.344 2.653 5.344 5.025 0 2.578-2.016 5.025-5.325 5.025h-3.919V7.416zm1.444 1.303v7.444h2.297c3.272 0 4.022-2.484 4.022-3.722 0-2.016-1.284-3.722-4.097-3.722h-2.222z"},child:[]}]})(t)}function mt(t){return W({tag:"svg",attr:{role:"img",viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19.586 0c-.818 0-1.508.19-2.073.565-.563.377-.97.936-1.213 1.68a3.193 3.193 0 0 0-.112.437 8.365 8.365 0 0 0-.078.53 9 9 0 0 0-.05.727c-.01.282-.013.621-.013 1.016a31.121 31.123 0 0 0 .014 1.017 9 9 0 0 0 .05.727 7.946 7.946 0 0 0 .077.53h-.005a3.334 3.334 0 0 0 .113.438c.245.743.65 1.303 1.214 1.68.565.376 1.256.564 2.075.564.8 0 1.536-.213 2.105-.603.57-.39.94-.916 1.175-1.65.076-.235.135-.558.177-.93a10.9 10.9 0 0 0 .043-1.207v-.82c0-.095-.047-.142-.14-.142h-3.064c-.094 0-.14.047-.14.141v.956c0 .094.046.14.14.14h1.666c.056 0 .084.03.084.086 0 .36 0 .62-.036.865-.038.244-.1.447-.147.606-.108.385-.348.664-.638.876-.29.212-.738.35-1.227.35-.545 0-.901-.15-1.21-.353-.306-.203-.517-.454-.67-.915a3.136 3.136 0 0 1-.147-.762 17.366 17.367 0 0 1-.034-.656c-.01-.26-.014-.572-.014-.939a26.401 26.403 0 0 1 .014-.938 15.821 15.822 0 0 1 .035-.656 3.19 3.19 0 0 1 .148-.76 1.89 1.89 0 0 1 .742-1.01c.344-.244.593-.352 1.137-.352.508 0 .815.096 1.144.303.33.207.528.492.764.925.047.094.111.118.198.07l1.044-.43c.075-.048.09-.115.042-.199a3.549 3.549 0 0 0-.466-.742 3 3 0 0 0-.679-.607 3.313 3.313 0 0 0-.903-.41A4.068 4.068 0 0 0 19.586 0zM8.217 5.836c-1.69 0-3.036.086-4.297.086-1.146 0-2.291 0-3.007-.029v.831l1.088.2c.744.144 1.174.488 1.174 2.264v11.288c0 1.777-.43 2.12-1.174 2.263l-1.088.2v.832c.773-.029 2.12-.086 3.465-.086 1.29 0 2.951.057 3.667.086v-.831l-1.49-.2c-.773-.115-1.174-.487-1.174-2.264v-4.784c.688.057 1.29.057 2.206.057 1.748 3.123 3.41 5.472 4.355 6.56.86 1.032 2.177 1.691 3.839 1.691.487 0 1.003-.086 1.318-.23v-.744c-1.031 0-2.063-.716-2.808-1.518-1.26-1.376-2.95-3.582-4.355-6.074 2.32-.545 4.04-2.722 4.04-4.9 0-3.208-2.492-4.698-5.758-4.698zm-.515 1.29c2.406 0 3.839 1.26 3.839 3.552 0 2.263-1.547 3.782-4.097 3.782-.974 0-1.404-.03-2.063-.086v-7.19c.66-.059 1.547-.059 2.32-.059z"},child:[]}]})(t)}export{ot as C,se as E,W as G,tt as L,nt as M,at as N,lt as P,ie as Q,it as R,dt as S,ct as a,st as b,rt as c,mt as d};
