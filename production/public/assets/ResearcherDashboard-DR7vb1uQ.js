import{c as z,v as Ws,r,M as Xs,j as e,P as ce,z as Ce,D as Js,O as Ee,u as Zs,a as et,b as M,G as Se,e as m,C as p,f as y,g as N,a5 as st,h as w,d as j,I as v,B as ae,n as tt,k as D,R as Pe,_ as k,V as C,o as at,Z as gs}from"./index-DsMkGSNQ.js";import{u as S}from"./useMutation-BIiySL2y.js";import{T as fs}from"./textarea-jlxMfcOq.js";import{c as Ns,R as rt,I as it}from"./index-B_Ogmu_i.js";import{u as lt}from"./index-CwynGiMj.js";import{u as nt}from"./index-DCOyCOZG.js";import{S as re}from"./skeleton-LtVR_Qyf.js";import{S as ie}from"./separator-MX7n0DGa.js";import{L as le}from"./label-DBXjDKEQ.js";import{U as ke}from"./user-CON3jPQo.js";import{E as q}from"./external-link-By5JbUa5.js";import{L as ot,C as ct,S as dt}from"./settings-D8g5zs8E.js";import{C as vs}from"./circle-check-big-DF4jmYxg.js";import{A as mt}from"./award-Bbq7CScr.js";import{F as R}from"./file-text-7bLv6ELf.js";import{S as Fe}from"./save-COP9v4K5.js";import{S as bs}from"./star-BbXoLBND.js";import{T as Te}from"./trash-2-CY__9cR9.js";import{P as xt}from"./plus-BzkEBtE6.js";import{E as ne,a as oe}from"./eye-DWE8iN3r.js";import{C as ht}from"./circle-x-BPGqW8UE.js";import{C as ys}from"./clock-CMaYpGuj.js";import{P as ut}from"./palette-B8tr1z9j.js";import{Q as pt}from"./qr-code-ymSEqRGv.js";import{D as jt}from"./download-Dl1CezvS.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gt=z("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=z("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vt=z("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=z("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=z("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=z("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var Ue="Tabs",[yt,Jt]=Ws(Ue,[Ns]),ws=Ns(),[Nt,Me]=yt(Ue),Cs=r.forwardRef((n,t)=>{const{__scopeTabs:o,value:d,onValueChange:g,defaultValue:b,orientation:x="horizontal",dir:P,activationMode:A="automatic",...I}=n,f=lt(P),[h,F]=Xs({prop:d,onChange:g,defaultProp:b});return e.jsx(Nt,{scope:o,baseId:nt(),value:h,onValueChange:F,orientation:x,dir:f,activationMode:A,children:e.jsx(ce.div,{dir:f,"data-orientation":x,...I,ref:t})})});Cs.displayName=Ue;var Ss="TabsList",Ps=r.forwardRef((n,t)=>{const{__scopeTabs:o,loop:d=!0,...g}=n,b=Me(Ss,o),x=ws(o);return e.jsx(rt,{asChild:!0,...x,orientation:b.orientation,dir:b.dir,loop:d,children:e.jsx(ce.div,{role:"tablist","aria-orientation":b.orientation,...g,ref:t})})});Ps.displayName=Ss;var ks="TabsTrigger",Fs=r.forwardRef((n,t)=>{const{__scopeTabs:o,value:d,disabled:g=!1,...b}=n,x=Me(ks,o),P=ws(o),A=Is(x.baseId,d),I=Es(x.baseId,d),f=d===x.value;return e.jsx(it,{asChild:!0,...P,focusable:!g,active:f,children:e.jsx(ce.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":I,"data-state":f?"active":"inactive","data-disabled":g?"":void 0,disabled:g,id:A,...b,ref:t,onMouseDown:Ce(n.onMouseDown,h=>{!g&&h.button===0&&h.ctrlKey===!1?x.onValueChange(d):h.preventDefault()}),onKeyDown:Ce(n.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&x.onValueChange(d)}),onFocus:Ce(n.onFocus,()=>{const h=x.activationMode!=="manual";!f&&!g&&h&&x.onValueChange(d)})})})});Fs.displayName=ks;var Ts="TabsContent",As=r.forwardRef((n,t)=>{const{__scopeTabs:o,value:d,forceMount:g,children:b,...x}=n,P=Me(Ts,o),A=Is(P.baseId,d),I=Es(P.baseId,d),f=d===P.value,h=r.useRef(f);return r.useEffect(()=>{const F=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(F)},[]),e.jsx(Js,{present:g||f,children:({present:F})=>e.jsx(ce.div,{"data-state":f?"active":"inactive","data-orientation":P.orientation,role:"tabpanel","aria-labelledby":A,hidden:!F,id:I,tabIndex:0,...x,ref:t,style:{...n.style,animationDuration:h.current?"0s":void 0},children:F&&b})})});As.displayName=Ts;function Is(n,t){return`${n}-trigger-${t}`}function Es(n,t){return`${n}-content-${t}`}var wt=Cs,Us=Ps,Ms=Fs,Rs=As;const Ct=wt,Os=r.forwardRef(({className:n,...t},o)=>e.jsx(Us,{ref:o,className:Ee("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",n),...t}));Os.displayName=Us.displayName;const O=r.forwardRef(({className:n,...t},o)=>e.jsx(Ms,{ref:o,className:Ee("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",n),...t}));O.displayName=Ms.displayName;const L=r.forwardRef(({className:n,...t},o)=>e.jsx(Rs,{ref:o,className:Ee("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),...t}));L.displayName=Rs.displayName;function Zt(){var ss,ts,as,rs,is,ls,ns,os,cs,ds,ms,xs,hs,us,ps,js;const[,n]=Zs(),{toast:t}=et(),[o,d]=r.useState(""),[g,b]=r.useState(""),[x,P]=r.useState(""),[A,I]=r.useState(""),[f,h]=r.useState(""),[F,Re]=r.useState(""),[Oe,Le]=r.useState(""),[$e,_e]=r.useState(""),[Ve,De]=r.useState(""),[qe,ze]=r.useState(""),[Z,Be]=r.useState(!1),de=r.useRef(null),Ge=r.useRef(null),[me,xe]=r.useState(!0),[Ls,he]=r.useState(null),[ue,Ke]=r.useState(""),[B,Ye]=r.useState(""),[pe,Qe]=r.useState(""),[je,$s]=r.useState(!1),[ge,_s]=r.useState(!1),[fe,ve]=r.useState(null),[G,K]=r.useState(""),[Y,Q]=r.useState(""),[He,ee]=r.useState("custom"),{data:U,isLoading:Vs}=M({queryKey:["/api/auth/me"]}),{data:i,isLoading:Ds}=M({queryKey:["/api/researcher/my-tenant"],enabled:!!(U!=null&&U.user)}),{data:T,isLoading:St,refetch:We}=M({queryKey:["/api/openalex/author",(ts=(ss=i==null?void 0:i.tenant)==null?void 0:ss.profile)==null?void 0:ts.openalexId],enabled:!!((rs=(as=i==null?void 0:i.tenant)==null?void 0:as.profile)!=null&&rs.openalexId)}),{data:H}=M({queryKey:["/api/themes"]}),{data:$}=M({queryKey:["/api/researcher/publications"],enabled:!!((ls=(is=i==null?void 0:i.tenant)==null?void 0:is.profile)!=null&&ls.openalexId)}),{data:se}=M({queryKey:["/api/researcher/sections"],enabled:!!((ns=i==null?void 0:i.tenant)!=null&&ns.profile)}),{data:W,refetch:qs}=M({queryKey:["/api/researcher/sync-logs"],enabled:!!((os=i==null?void 0:i.tenant)!=null&&os.profile)});r.useEffect(()=>{var s;if((s=i==null?void 0:i.tenant)!=null&&s.profile){const a=i.tenant.profile;d(a.openalexId||""),b(a.displayName||""),P(a.title||""),I(a.bio||""),h(a.websiteUrl||""),Re(a.twitterUrl||""),Le(a.linkedinUrl||""),_e(a.googleScholarUrl||""),De(a.orcidUrl||""),ze(a.researchGateUrl||""),xe(a.isPublic!==!1),he(a.selectedThemeId||null)}},[i]);const zs=S({mutationFn:async()=>{await k("POST","/api/auth/logout")},onSuccess:()=>{C.clear(),n("/dashboard/login")}}),X=S({mutationFn:async s=>(await k("PATCH","/api/researcher/profile",s)).json(),onSuccess:()=>{t({title:"Saved!",description:"Your profile has been updated."}),C.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),_=S({mutationFn:async()=>(await k("POST","/api/researcher/sync")).json(),onSuccess:()=>{t({title:"Synced!",description:"Your profile data has been refreshed from OpenAlex."}),C.invalidateQueries({queryKey:["/api/researcher/my-tenant"]}),We()},onError:s=>{t({title:"Sync Failed",description:s.message,variant:"destructive"})}}),J=S({mutationFn:async s=>{const a=await fetch(`https://api.openalex.org/authors/${s}`);if(!a.ok)throw new Error("Author not found in OpenAlex");return a.json()},onSuccess:async s=>{t({title:"Author Found!",description:`${s.display_name} with ${s.works_count} publications`}),await X.mutateAsync({openalexId:o}),We()},onError:()=>{t({title:"Not Found",description:"Could not find this author in OpenAlex. Check the ID.",variant:"destructive"})}}),te=S({mutationFn:async s=>{const a=new FormData;a.append("photo",s);const l=await fetch("/api/researcher/upload-photo",{method:"POST",body:a,credentials:"include"});if(!l.ok){const V=await l.json();throw new Error(V.message||"Failed to upload photo")}return l.json()},onSuccess:()=>{t({title:"Photo Updated!",description:"Your profile photo has been uploaded."}),C.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{t({title:"Upload Failed",description:s.message,variant:"destructive"})}}),be=S({mutationFn:async s=>{const a=new FormData;a.append("cv",s);const l=await fetch("/api/researcher/upload-cv",{method:"POST",body:a,credentials:"include"});if(!l.ok){const V=await l.json();throw new Error(V.message||"Failed to upload CV")}return l.json()},onSuccess:()=>{t({title:"CV Uploaded!",description:"Your CV has been uploaded successfully."}),C.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{t({title:"Upload Failed",description:s.message,variant:"destructive"})}}),Xe=S({mutationFn:async()=>(await k("DELETE","/api/researcher/cv")).json(),onSuccess:()=>{t({title:"CV Removed",description:"Your CV has been removed from your profile."}),C.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),ye=S({mutationFn:async s=>(await k("PATCH","/api/auth/password",s)).json(),onSuccess:()=>{t({title:"Password Changed!",description:"Your password has been updated successfully."}),Ke(""),Ye(""),Qe("")},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),Bs=s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];if(a){if(a.size>5*1024*1024){t({title:"File too large",description:"Please choose an image under 5MB",variant:"destructive"});return}te.mutate(a)}},Gs=s=>{var l;const a=(l=s.target.files)==null?void 0:l[0];if(a){if(a.size>10*1024*1024){t({title:"File too large",description:"Please choose a document under 10MB",variant:"destructive"});return}be.mutate(a)}},Ks=()=>{if(B!==pe){t({title:"Passwords don't match",description:"New password and confirmation must match",variant:"destructive"});return}if(B.length<8){t({title:"Password too short",description:"Password must be at least 8 characters",variant:"destructive"});return}ye.mutate({currentPassword:ue,newPassword:B})},Ys=async s=>{xe(s);try{await X.mutateAsync({isPublic:s})}catch{xe(!s)}},Qs=async s=>{var a,l;he(s);try{await X.mutateAsync({selectedThemeId:s})}catch{he(((l=(a=i==null?void 0:i.tenant)==null?void 0:a.profile)==null?void 0:l.selectedThemeId)||null)}},Je=S({mutationFn:async({publicationId:s,isFeatured:a})=>(await k("PATCH",`/api/researcher/publications/${s}/feature`,{isFeatured:a})).json(),onSuccess:()=>{C.invalidateQueries({queryKey:["/api/researcher/publications"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),Ze=S({mutationFn:async s=>(await k("POST","/api/researcher/sections",s)).json(),onSuccess:()=>{t({title:"Section Created!",description:"Your new section has been added."}),C.invalidateQueries({queryKey:["/api/researcher/sections"]}),K(""),Q(""),ee("custom")},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),Ne=S({mutationFn:async({id:s,...a})=>(await k("PATCH",`/api/researcher/sections/${s}`,a)).json(),onSuccess:()=>{t({title:"Section Updated!",description:"Your changes have been saved."}),C.invalidateQueries({queryKey:["/api/researcher/sections"]}),ve(null),K(""),Q("")},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),Hs=S({mutationFn:async s=>(await k("DELETE",`/api/researcher/sections/${s}`)).json(),onSuccess:()=>{t({title:"Section Deleted",description:"The section has been removed."}),C.invalidateQueries({queryKey:["/api/researcher/sections"]})},onError:s=>{t({title:"Error",description:s.message,variant:"destructive"})}}),es=async()=>{Be(!0);try{await X.mutateAsync({displayName:g||null,title:x||null,bio:A||null,websiteUrl:f||null,twitterUrl:F||null,linkedinUrl:Oe||null,googleScholarUrl:$e||null,orcidUrl:Ve||null,researchGateUrl:qe||null})}finally{Be(!1)}};if(Vs||Ds)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsx(re,{className:"h-20 w-full"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(re,{className:"h-32"}),e.jsx(re,{className:"h-32"}),e.jsx(re,{className:"h-32"})]})]})});if(!(U!=null&&U.user))return n("/dashboard/login"),null;const u=i==null?void 0:i.tenant,c=u==null?void 0:u.profile,E=((cs=u==null?void 0:u.domains)==null?void 0:cs.find(s=>s.isPrimary))||((ds=u==null?void 0:u.domains)==null?void 0:ds[0]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("header",{className:"border-b bg-white sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-[#0B1F3A] to-[#233F5F] rounded-xl flex items-center justify-center",children:e.jsx(ke,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-slate-900",children:"My Portfolio"}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Welcome, ",U.user.firstName]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[E&&e.jsxs("a",{href:`https://${E.hostname}`,target:"_blank",rel:"noopener noreferrer",className:"hidden md:flex items-center gap-2 text-sm text-slate-600 hover:text-slate-900",children:[e.jsx(Se,{className:"w-4 h-4"}),E.hostname,e.jsx(q,{className:"w-3 h-3"})]}),e.jsxs(m,{variant:"ghost",size:"sm",onClick:()=>zs.mutate(),className:"text-slate-600 hover:text-slate-900","data-testid":"button-logout",children:[e.jsx(ot,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]})}),e.jsxs("main",{className:"max-w-5xl mx-auto px-4 py-8 space-y-8",children:[c!=null&&c.openalexId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(p,{children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Publications"}),e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:((ms=T==null?void 0:T.works_count)==null?void 0:ms.toLocaleString())||"—"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(ae,{className:"w-6 h-6 text-blue-600"})})]})})}),e.jsx(p,{children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Citations"}),e.jsx("p",{className:"text-3xl font-bold text-slate-900",children:((xs=T==null?void 0:T.cited_by_count)==null?void 0:xs.toLocaleString())||"—"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(tt,{className:"w-6 h-6 text-green-600"})})]})})}),e.jsx(p,{children:e.jsx(j,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-500",children:"Status"}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:(u==null?void 0:u.status)==="active"?e.jsxs(e.Fragment,{children:[e.jsx(vs,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-lg font-medium text-green-600",children:"Live"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ct,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-lg font-medium text-yellow-600",children:"Pending"})]})})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(mt,{className:"w-6 h-6 text-purple-600"})})]})})})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(D,{className:"bg-slate-100 text-slate-700",children:["OpenAlex: ",c.openalexId]}),c.lastSyncedAt&&e.jsxs("span",{className:"text-sm text-slate-500",children:["Last synced: ",new Date(c.lastSyncedAt).toLocaleDateString()]})]}),e.jsxs(m,{variant:"outline",size:"sm",onClick:()=>_.mutate(),disabled:_.isPending,"data-testid":"button-sync",children:[e.jsx(Pe,{className:`w-4 h-4 mr-2 ${_.isPending?"animate-spin":""}`}),"Refresh Data"]})]})]}):e.jsxs(p,{className:"border-orange-200 bg-orange-50",children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2 text-orange-800",children:[e.jsx(st,{className:"w-5 h-5"}),"Connect Your OpenAlex Profile"]}),e.jsx(w,{className:"text-orange-700",children:"Enter your OpenAlex author ID to automatically import your publications, metrics, and research topics."})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{value:o,onChange:s=>d(s.target.value),placeholder:"e.g., A5023888391",className:"flex-1","data-testid":"input-openalex-id"}),e.jsx(m,{onClick:()=>J.mutate(o),disabled:!o||J.isPending,className:"bg-orange-500 hover:bg-orange-600","data-testid":"button-verify-openalex",children:J.isPending?"Checking...":"Connect"})]}),e.jsxs("p",{className:"text-sm text-orange-600",children:["Find your ID by searching your name on"," ",e.jsx("a",{href:"https://openalex.org/authors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"OpenAlex Authors"})]})]})]}),e.jsxs(Ct,{defaultValue:"profile",className:"w-full",children:[e.jsxs(Os,{className:"flex flex-wrap justify-start gap-1 w-full lg:grid lg:grid-cols-6 lg:w-[720px] h-auto p-1",children:[e.jsxs(O,{value:"profile","data-testid":"tab-profile",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(ke,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile"})]}),e.jsxs(O,{value:"publications","data-testid":"tab-publications",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(ae,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Publications"})]}),e.jsxs(O,{value:"sections","data-testid":"tab-sections",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(R,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sections"})]}),e.jsxs(O,{value:"sync","data-testid":"tab-sync",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(Ae,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sync"})]}),e.jsxs(O,{value:"social","data-testid":"tab-social",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(Se,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Social"})]}),e.jsxs(O,{value:"settings","data-testid":"tab-settings",className:"flex-1 min-w-[80px] text-xs sm:text-sm",children:[e.jsx(dt,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]}),e.jsxs(L,{value:"profile",className:"mt-6 space-y-6",children:[e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(N,{children:"Profile Photo"}),e.jsx(w,{children:"Upload a professional photo to personalize your portfolio"})]}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[c!=null&&c.profileImageUrl?e.jsx("img",{src:c.profileImageUrl,alt:"Profile",className:"w-24 h-24 rounded-full object-cover border-4 border-slate-100"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-[#0B1F3A] to-[#233F5F] flex items-center justify-center",children:e.jsx(ke,{className:"w-10 h-10 text-white"})}),e.jsx("button",{onClick:()=>{var s;return(s=de.current)==null?void 0:s.click()},disabled:te.isPending,className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center border border-slate-200 hover:bg-slate-50 transition-colors","data-testid":"button-change-photo",children:e.jsx(gt,{className:"w-4 h-4 text-slate-600"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:de,type:"file",accept:"image/*",onChange:Bs,className:"hidden","data-testid":"input-photo-file"}),e.jsxs(m,{variant:"outline",onClick:()=>{var s;return(s=de.current)==null?void 0:s.click()},disabled:te.isPending,"data-testid":"button-upload-photo",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),te.isPending?"Uploading...":"Upload Photo"]}),e.jsx("p",{className:"text-sm text-slate-500 mt-2",children:"JPG, PNG or GIF. Max 5MB."})]})]})})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(N,{children:"Profile Information"}),e.jsx(w,{children:"Customize how your name and biography appear on your portfolio"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Display Name"}),e.jsx(v,{value:g,onChange:s=>b(s.target.value),placeholder:(T==null?void 0:T.display_name)||"Your Name","data-testid":"input-display-name"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Leave blank to use your name from OpenAlex"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Professional Title"}),e.jsx(v,{value:x,onChange:s=>P(s.target.value),placeholder:"e.g., Associate Professor of Computer Science","data-testid":"input-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Biography"}),e.jsx(fs,{value:A,onChange:s=>I(s.target.value),placeholder:"Tell visitors about your research interests, background, and achievements...",className:"min-h-[150px]","data-testid":"input-bio"})]}),e.jsxs(m,{onClick:es,disabled:Z,className:"bg-[#0B1F3A] hover:bg-[#1a3a5c]","data-testid":"button-save-profile",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),Z?"Saving...":"Save Changes"]})]})]})]}),e.jsx(L,{value:"publications",className:"mt-6 space-y-6",children:e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"w-5 h-5 text-yellow-500"}),"Featured Publications"]}),e.jsx(w,{children:"Mark publications as featured to highlight them on your portfolio. Featured publications appear prominently at the top of your publications list."})]}),e.jsx(j,{children:(us=(hs=i==null?void 0:i.tenant)==null?void 0:hs.profile)!=null&&us.openalexId?(ps=$==null?void 0:$.publications)!=null&&ps.length?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-slate-500 pb-2 border-b",children:[e.jsxs("span",{children:[$.publications.filter(s=>s.isFeatured).length," featured"]}),e.jsxs("span",{children:[$.publications.length," total publications"]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto space-y-2",children:$.publications.map(s=>e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors ${s.isFeatured?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200 hover:border-slate-300"}`,children:[e.jsx("button",{onClick:()=>Je.mutate({publicationId:s.id,isFeatured:!s.isFeatured}),className:`mt-1 transition-colors ${s.isFeatured?"text-yellow-500":"text-slate-300 hover:text-yellow-400"}`,disabled:Je.isPending,children:e.jsx(bs,{className:`w-5 h-5 ${s.isFeatured?"fill-current":""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-slate-900 line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[s.journal&&e.jsx("span",{children:s.journal}),s.publicationYear&&e.jsxs("span",{children:[" • ",s.publicationYear]}),s.citationCount>0&&e.jsxs("span",{children:[" • ",s.citationCount," citations"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[s.isOpenAccess&&e.jsx(D,{variant:"outline",className:"text-green-600 border-green-300 text-xs",children:"Open Access"}),s.doi&&e.jsxs("a",{href:`https://doi.org/${s.doi}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx(q,{className:"w-3 h-3"}),"DOI"]}),s.pdfUrl?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("a",{href:s.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-green-600 hover:underline flex items-center gap-1",children:[e.jsx(R,{className:"w-3 h-3"}),"PDF"]}),e.jsx("button",{onClick:async()=>{if(confirm("Remove the uploaded PDF?"))try{await k("DELETE",`/api/researcher/publications/${s.id}/pdf`),t({title:"PDF removed",description:"Publication PDF has been deleted."}),C.invalidateQueries({queryKey:["/api/researcher/publications"]})}catch{t({title:"Error",description:"Failed to remove PDF",variant:"destructive"})}},className:"text-xs text-red-500 hover:text-red-700",title:"Remove PDF",children:e.jsx(Te,{className:"w-3 h-3"})})]}):e.jsxs("label",{className:"text-xs text-slate-500 hover:text-blue-600 cursor-pointer flex items-center gap-1",children:[e.jsx(Ie,{className:"w-3 h-3"}),"Upload PDF",e.jsx("input",{type:"file",accept:".pdf",className:"hidden",onChange:async a=>{var V;const l=(V=a.target.files)==null?void 0:V[0];if(l){if(l.size>20*1024*1024){t({title:"File too large",description:"PDF must be under 20MB",variant:"destructive"});return}try{const we=new FormData;if(we.append("pdf",l),!(await fetch(`/api/researcher/publications/${s.id}/pdf`,{method:"POST",body:we,credentials:"include"})).ok)throw new Error("Upload failed");t({title:"PDF uploaded",description:"Publication PDF has been saved."}),C.invalidateQueries({queryKey:["/api/researcher/publications"]})}catch{t({title:"Error",description:"Failed to upload PDF",variant:"destructive"})}a.target.value=""}}})]})]})]})]},s.id))})]}):e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No publications found. Try syncing your profile."}),e.jsxs(m,{onClick:()=>_.mutate(),variant:"outline",className:"mt-4",disabled:_.isPending,children:[e.jsx(Pe,{className:`w-4 h-4 mr-2 ${_.isPending?"animate-spin":""}`}),"Sync Now"]})]}):e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(ae,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Connect your OpenAlex ID to manage publications"})]})})]})}),e.jsx(L,{value:"sections",className:"mt-6 space-y-6",children:e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5 text-blue-500"}),"Content Sections"]}),e.jsx(w,{children:"Add custom sections to your portfolio such as Research Interests, Awards, Teaching, or any other content you want to showcase."})]}),e.jsxs(j,{children:[e.jsxs("div",{className:"space-y-4 pb-6 border-b",children:[e.jsx("h4",{className:"font-medium text-sm text-slate-900",children:fe?"Edit Section":"Add New Section"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Section Title"}),e.jsx(v,{value:G,onChange:s=>K(s.target.value),placeholder:"e.g., Research Interests, Awards, Teaching"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Section Type"}),e.jsxs("select",{value:He,onChange:s=>ee(s.target.value),className:"w-full h-10 px-3 rounded-md border border-slate-200 bg-white text-sm",children:[e.jsx("option",{value:"custom",children:"Custom"}),e.jsx("option",{value:"research_interests",children:"Research Interests"}),e.jsx("option",{value:"awards",children:"Awards & Honors"}),e.jsx("option",{value:"teaching",children:"Teaching"}),e.jsx("option",{value:"grants",children:"Grants & Funding"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Content"}),e.jsx(fs,{value:Y,onChange:s=>Q(s.target.value),placeholder:"Enter your content here. You can use markdown for formatting...",className:"min-h-[120px]"})]}),e.jsx("div",{className:"flex gap-2",children:fe?e.jsxs(e.Fragment,{children:[e.jsxs(m,{onClick:()=>{Ne.mutate({id:fe,title:G,content:Y})},disabled:!G||!Y||Ne.isPending,className:"bg-[#0B1F3A] hover:bg-[#1a3a5c]",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Save Changes"]}),e.jsx(m,{variant:"outline",onClick:()=>{ve(null),K(""),Q(""),ee("custom")},children:"Cancel"})]}):e.jsxs(m,{onClick:()=>{Ze.mutate({title:G,content:Y,sectionType:He})},disabled:!G||!Y||Ze.isPending,className:"bg-[#0B1F3A] hover:bg-[#1a3a5c]",children:[e.jsx(xt,{className:"w-4 h-4 mr-2"}),"Add Section"]})})]}),e.jsxs("div",{className:"pt-6 space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-slate-900",children:"Your Sections"}),(js=se==null?void 0:se.sections)!=null&&js.length?e.jsx("div",{className:"space-y-2",children:se.sections.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border bg-white border-slate-200",children:[e.jsx(vt,{className:"w-4 h-4 mt-1 text-slate-400 cursor-move"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h5",{className:"font-medium text-slate-900",children:s.title}),e.jsx(D,{variant:"outline",className:"text-xs",children:s.sectionType}),!s.isVisible&&e.jsx(D,{variant:"outline",className:"text-xs text-orange-600 border-orange-300",children:"Hidden"})]}),e.jsx("p",{className:"text-sm text-slate-500 mt-1 line-clamp-2",children:s.content})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{ve(s.id),K(s.title),Q(s.content),ee(s.sectionType)},children:e.jsx(bt,{className:"w-4 h-4"})}),e.jsx(m,{variant:"ghost",size:"sm",onClick:()=>{Ne.mutate({id:s.id,isVisible:!s.isVisible})},children:s.isVisible?e.jsx(ne,{className:"w-4 h-4"}):e.jsx(oe,{className:"w-4 h-4"})}),e.jsx(m,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50",onClick:()=>{confirm("Are you sure you want to delete this section?")&&Hs.mutate(s.id)},children:e.jsx(Te,{className:"w-4 h-4"})})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-slate-500",children:[e.jsx(R,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No custom sections yet. Add one above!"})]})]})]})]})}),e.jsx(L,{value:"sync",className:"mt-6 space-y-6",children:e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),"OpenAlex Sync Management"]}),e.jsx(w,{children:"View sync history and manually trigger data synchronization from OpenAlex"})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-900",children:"Sync Publications"}),e.jsx("p",{className:"text-sm text-slate-500",children:"Fetch latest publications and citations from OpenAlex"})]}),e.jsxs(m,{onClick:async()=>{try{if((await fetch("/api/researcher/sync",{method:"POST",credentials:"include"})).ok)t({title:"Sync started",description:"Your publications are being synced from OpenAlex"}),qs();else throw new Error("Failed to start sync")}catch{t({title:"Sync failed",description:"Could not start sync. Please try again.",variant:"destructive"})}},children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Sync Now"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-slate-900 mb-4",children:"Sync History"}),!(W!=null&&W.logs)||W.logs.length===0?e.jsxs("div",{className:"text-center py-8 text-slate-500 bg-slate-50 rounded-lg border border-dashed",children:[e.jsx(Ae,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No sync history yet"}),e.jsx("p",{className:"text-sm",children:'Click "Sync Now" to fetch your latest publications'})]}):e.jsx("div",{className:"space-y-3",children:W.logs.map(s=>e.jsxs("div",{className:`p-4 rounded-lg border ${s.status==="completed"?"bg-green-50 border-green-200":s.status==="failed"?"bg-red-50 border-red-200":s.status==="in_progress"?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="completed"&&e.jsx(ft,{className:"w-5 h-5 text-green-600"}),s.status==="failed"&&e.jsx(ht,{className:"w-5 h-5 text-red-600"}),s.status==="in_progress"&&e.jsx(ys,{className:"w-5 h-5 text-blue-600 animate-pulse"}),s.status==="pending"&&e.jsx(ys,{className:"w-5 h-5 text-slate-400"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-slate-900 capitalize",children:[s.syncType.replace("_"," ")," Sync"]}),e.jsxs("p",{className:"text-sm text-slate-500",children:["Started: ",new Date(s.startedAt).toLocaleString()]})]})]}),e.jsx(D,{variant:"outline",className:`${s.status==="completed"?"text-green-700 border-green-300":s.status==="failed"?"text-red-700 border-red-300":s.status==="in_progress"?"text-blue-700 border-blue-300":"text-slate-700 border-slate-300"}`,children:s.status})]}),s.itemsProcessed!==null&&e.jsxs("p",{className:"text-sm text-slate-600 mt-2",children:["Processed: ",s.itemsProcessed,s.itemsTotal?` / ${s.itemsTotal}`:""," items"]}),s.errorMessage&&e.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["Error: ",s.errorMessage]}),s.completedAt&&e.jsxs("p",{className:"text-xs text-slate-400 mt-2",children:["Completed: ",new Date(s.completedAt).toLocaleString()]})]},s.id))})]})]})]})}),e.jsx(L,{value:"social",className:"mt-6 space-y-6",children:e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(N,{children:"Social Links"}),e.jsx(w,{children:"Add links to your other profiles and websites"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Personal Website"}),e.jsx(v,{value:f,onChange:s=>h(s.target.value),placeholder:"https://yourwebsite.com",type:"url","data-testid":"input-website"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Twitter / X"}),e.jsx(v,{value:F,onChange:s=>Re(s.target.value),placeholder:"https://twitter.com/yourusername",type:"url","data-testid":"input-twitter"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"LinkedIn"}),e.jsx(v,{value:Oe,onChange:s=>Le(s.target.value),placeholder:"https://linkedin.com/in/yourusername",type:"url","data-testid":"input-linkedin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Google Scholar"}),e.jsx(v,{value:$e,onChange:s=>_e(s.target.value),placeholder:"https://scholar.google.com/citations?user=...",type:"url","data-testid":"input-google-scholar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"ORCID"}),e.jsx(v,{value:Ve,onChange:s=>De(s.target.value),placeholder:"https://orcid.org/0000-0000-0000-0000",type:"url","data-testid":"input-orcid"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"ResearchGate"}),e.jsx(v,{value:qe,onChange:s=>ze(s.target.value),placeholder:"https://www.researchgate.net/profile/Your-Name",type:"url","data-testid":"input-researchgate"})]}),e.jsxs(m,{onClick:es,disabled:Z,className:"bg-[#0B1F3A] hover:bg-[#1a3a5c]","data-testid":"button-save-social",children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),Z?"Saving...":"Save Changes"]})]})]})}),e.jsxs(L,{value:"settings",className:"mt-6 space-y-6",children:[e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[me?e.jsx(ne,{className:"w-5 h-5 text-green-600"}):e.jsx(oe,{className:"w-5 h-5 text-slate-400"}),"Profile Visibility"]}),e.jsx(w,{children:"Control who can see your research portfolio"})]}),e.jsx(j,{children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(le,{htmlFor:"profile-visibility",className:"text-base font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-slate-500",children:me?"Your portfolio is visible to everyone on the internet":"Your portfolio is hidden from public view"})]}),e.jsx(at,{id:"profile-visibility",checked:me,onCheckedChange:Ys,disabled:X.isPending})]})})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(R,{className:"w-5 h-5"}),"CV / Resume"]}),e.jsx(w,{children:"Upload your CV to allow visitors to download it from your portfolio"})]}),e.jsx(j,{className:"space-y-4",children:c!=null&&c.cvUrl?e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx(R,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-green-800",children:"CV Uploaded"}),e.jsx("p",{className:"text-sm text-green-600",children:"Your CV is available for download on your portfolio"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("a",{href:c.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700",children:[e.jsx(q,{className:"w-3 h-3"}),"View"]}),e.jsx(m,{variant:"outline",size:"sm",onClick:()=>Xe.mutate(),disabled:Xe.isPending,className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:e.jsx(Te,{className:"w-4 h-4"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-6 text-center",children:[e.jsx(R,{className:"w-10 h-10 text-slate-400 mx-auto mb-3"}),e.jsx("p",{className:"text-slate-600 mb-3",children:"No CV uploaded yet"}),e.jsx("input",{ref:Ge,type:"file",accept:".pdf,.doc,.docx",onChange:Gs,className:"hidden"}),e.jsxs(m,{variant:"outline",onClick:()=>{var s;return(s=Ge.current)==null?void 0:s.click()},disabled:be.isPending,children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),be.isPending?"Uploading...":"Upload CV"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"PDF, DOC, or DOCX. Max 10MB."})]})})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(ut,{className:"w-5 h-5"}),"Portfolio Theme"]}),e.jsx(w,{children:"Choose a color theme for your research portfolio"})]}),e.jsxs(j,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:H==null?void 0:H.filter(s=>s.isActive).map(s=>{const a=s.config,l=Ls===s.id;return e.jsxs("button",{onClick:()=>Qs(s.id),className:`relative p-4 rounded-lg border-2 transition-all ${l?"border-blue-500 bg-blue-50 ring-2 ring-blue-200":"border-slate-200 hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-slate-200",style:{backgroundColor:a.colors.primary}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200",style:{backgroundColor:a.colors.accent}})]}),e.jsx("p",{className:"text-sm font-medium text-left",children:s.name}),l&&e.jsx(vs,{className:"absolute top-2 right-2 w-5 h-5 text-blue-500"})]},s.id)})}),(!H||H.length===0)&&e.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"No themes available. Contact your administrator."})]})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsx(N,{children:"Account Settings"}),e.jsx(w,{children:"Manage your account and portfolio settings"})]}),e.jsxs(j,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Preview Portfolio"}),c!=null&&c.openalexId?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsx(q,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-blue-700",children:"See how visitors will view your portfolio"}),e.jsxs("a",{href:`/researcher/${c.openalexId}`,target:"_blank",rel:"noopener noreferrer",className:"ml-auto bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-blue-700 flex items-center gap-1","data-testid":"link-preview-portfolio",children:["Preview",e.jsx(q,{className:"w-3 h-3"})]})]}):e.jsx("p",{className:"text-sm text-slate-500",children:"Connect your OpenAlex ID to preview your portfolio"})]}),e.jsx(ie,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"QR Code"}),c!=null&&c.openalexId?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-purple-50 rounded-lg border border-purple-100",children:[e.jsx(pt,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-purple-700",children:"Download a QR code linking to your portfolio"}),e.jsxs("a",{href:`/api/researcher/${c.openalexId}/qr-code${E?`?url=https://${E.hostname}`:""}`,download:`${c.displayName||"portfolio"}-qr-code.png`,className:"ml-auto bg-purple-600 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-purple-700 flex items-center gap-1","data-testid":"link-download-qr",children:[e.jsx(jt,{className:"w-3 h-3"}),"Download QR"]})]}):e.jsx("p",{className:"text-sm text-slate-500",children:"Connect your OpenAlex ID to generate a QR code"})]}),e.jsx(ie,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Your Domain"}),E?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-slate-50 rounded-lg",children:[e.jsx(Se,{className:"w-4 h-4 text-slate-500"}),e.jsx("span",{className:"font-medium",children:E.hostname}),e.jsxs("a",{href:`https://${E.hostname}`,target:"_blank",rel:"noopener noreferrer",className:"ml-auto text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:["Visit Site",e.jsx(q,{className:"w-3 h-3"})]})]}):e.jsx("p",{className:"text-sm text-slate-500",children:"Your domain will be assigned by the administrator"})]}),e.jsx(ie,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"Plan"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-slate-50 rounded-lg",children:[e.jsx(D,{className:"capitalize",children:u==null?void 0:u.plan}),e.jsx("span",{className:"text-sm text-slate-500",children:"Contact support to change your plan"})]})]}),e.jsx(ie,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-slate-700",children:"OpenAlex ID"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(v,{value:o,onChange:s=>d(s.target.value),placeholder:"e.g., A5023888391",className:"flex-1","data-testid":"input-change-openalex-id"}),e.jsx(m,{variant:"outline",onClick:()=>J.mutate(o),disabled:!o||J.isPending,"data-testid":"button-update-openalex",children:"Update"})]})]})]})]}),e.jsxs(p,{children:[e.jsxs(y,{children:[e.jsxs(N,{className:"flex items-center gap-2",children:[e.jsx(gs,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(w,{children:"Update your account password"})]}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"current-password",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"current-password",type:je?"text":"password",value:ue,onChange:s=>Ke(s.target.value),placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>$s(!je),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:je?e.jsx(oe,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(v,{id:"new-password",type:ge?"text":"password",value:B,onChange:s=>Ye(s.target.value),placeholder:"Enter new password (min. 8 characters)"}),e.jsx("button",{type:"button",onClick:()=>_s(!ge),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600",children:ge?e.jsx(oe,{className:"w-4 h-4"}):e.jsx(ne,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(le,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsx(v,{id:"confirm-password",type:"password",value:pe,onChange:s=>Qe(s.target.value),placeholder:"Confirm new password"})]}),e.jsxs(m,{onClick:Ks,disabled:!ue||!B||!pe||ye.isPending,className:"bg-[#0B1F3A] hover:bg-[#1a3a5c]",children:[e.jsx(gs,{className:"w-4 h-4 mr-2"}),ye.isPending?"Updating...":"Update Password"]})]})]})]})]})]})]})}export{Zt as default};
