import{b,j as e}from"./vendor-query-CD7Z7DR7.js";import{r as d}from"./vendor-react-DHpf67ko.js";import{i as N,j as y,S as v,G as S,B as i,C,l as F,aa as E,m as k,n as P,k as L,I as m,a3 as I,a9 as O,s as T}from"./index-CSSeCMaq.js";import{u as B,z as l}from"./vendor-forms-Cwr-vjy6.js";import{F as G,a as x,b as u,c as h,d as p,e as j,t as H}from"./form-BByI_mkU.js";import{A as M}from"./arrow-left-AjNpvxnc.js";import{a as A,E as R}from"./eye-BZcpANvC.js";import"./vendor-charts-4dyn6-nb.js";import"./label-Bd5zOz9s.js";const W=l.object({email:l.string().email("Please enter a valid email address"),password:l.string().min(1,"Password is required")});function Y(){const[,r]=N(),{toast:c}=y(),[t,f]=d.useState(!1);d.useEffect(()=>{window.scrollTo(0,0)},[]);const o=B({resolver:H(W),defaultValues:{email:"",password:""}}),n=b({mutationFn:async s=>{const a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const w=await a.json();throw new Error(w.message||"Login failed")}return a.json()},onSuccess:s=>{var a;c({title:"Welcome back!",description:"Redirecting to your dashboard..."}),((a=s.user)==null?void 0:a.role)==="admin"?r("/admin"):r("/dashboard")},onError:s=>{c({title:"Login failed",description:s.message,variant:"destructive"})}}),g=s=>{n.mutate(s)};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(v,{title:"Sign In — Scholar.name",description:"Sign in to manage your academic portfolio on Scholar.name.",url:"https://scholar.name/login",type:"website"}),e.jsx(S,{mode:"auth"}),e.jsxs("div",{className:"flex-1 max-w-md mx-auto w-full px-4 py-12",children:[e.jsxs(i,{variant:"ghost",className:"mb-6",onClick:()=>r("/"),children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),e.jsxs(C,{children:[e.jsxs(F,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(E,{className:"w-6 h-6 text-primary"})}),e.jsx(k,{className:"text-2xl",children:"Welcome back"}),e.jsx(P,{children:"Sign in to manage your research portfolio"})]}),e.jsx(L,{children:e.jsx(G,{...o,children:e.jsxs("form",{onSubmit:o.handleSubmit(g),className:"space-y-4",children:[e.jsx(x,{control:o.control,name:"email",render:({field:s})=>e.jsxs(u,{children:[e.jsx(h,{children:"Email"}),e.jsx(p,{children:e.jsx(m,{type:"email",placeholder:"jane.smith@university.edu",autoComplete:"email",...s})}),e.jsx(j,{})]})}),e.jsx(x,{control:o.control,name:"password",render:({field:s})=>e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Password"}),e.jsx("a",{href:"/forgot-password",className:"text-xs text-primary hover:underline",children:"Forgot password?"})]}),e.jsx(p,{children:e.jsxs("div",{className:"relative",children:[e.jsx(m,{type:t?"text":"password",placeholder:"••••••••",autoComplete:"current-password",...s}),e.jsx("button",{type:"button","aria-label":t?"Hide password":"Show password",onClick:()=>f(!t),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:t?e.jsx(A,{className:"w-4 h-4"}):e.jsx(R,{className:"w-4 h-4"})})]})}),e.jsx(j,{})]})}),e.jsx(i,{type:"submit",className:"w-full btn-premium py-6",disabled:n.isPending,children:n.isPending?e.jsxs(e.Fragment,{children:[e.jsx(I,{className:"w-4 h-4 mr-2 animate-spin"}),"Signing in..."]}):"Sign in"})]})})}),e.jsxs(O,{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or"})})]}),e.jsx(i,{variant:"outline",className:"w-full",onClick:()=>r("/signup"),children:"Create a new account"})]})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6",children:["Need help?"," ",e.jsx("a",{href:"/contact",className:"text-primary hover:underline",children:"Contact support"})]})]}),e.jsx(T,{mode:"landing"})]})}export{Y as default};
