import{u as j,b as O,j as e}from"./vendor-query-CD7Z7DR7.js";import{r as z}from"./vendor-react-DHpf67ko.js";import{c as I,i as E,j as F,B as v,C as i,k as r,U as K,l as R,m as H,t as Q,L as n,r as y,q as G,V,O as W}from"./index-CJmn97el.js";import{S as c}from"./skeleton-DPQkBcok.js";import{S as X,L as J,C as Y}from"./settings-YrAE_IWi.js";import{T as C}from"./trending-up-QESx64wM.js";import{C as P}from"./circle-check-big-DUhufJtA.js";import{C as g}from"./clock-CdJPOx7e.js";import{C as d}from"./chevron-right-D-yZySTv.js";import{P as Z}from"./palette-BnRSgpd3.js";import{P as k}from"./plus-VDJ3sYem.js";import{C as _}from"./circle-x-wTS8txwF.js";import"./vendor-charts-4dyn6-nb.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=I("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]),u={active:{icon:P,color:"text-green-400",bg:"bg-green-500/10"},pending:{icon:g,color:"text-yellow-400",bg:"bg-yellow-500/10"},suspended:{icon:Y,color:"text-orange-400",bg:"bg-orange-500/10"},cancelled:{icon:_,color:"text-red-400",bg:"bg-red-500/10"}},D={starter:"bg-blue-500/20 text-blue-300",professional:"bg-purple-500/20 text-purple-300",institution:"bg-amber-500/20 text-amber-300"};function oe(){const[,x]=E();F();const{data:a,isLoading:m}=j({queryKey:["/api/auth/me"]}),{data:h,isLoading:T}=j({queryKey:["/api/admin/tenants"],enabled:!!(a!=null&&a.user)}),{data:o}=j({queryKey:["/api/admin/analytics"],enabled:!!(a!=null&&a.user)}),L=O({mutationFn:async()=>{await V("POST","/api/auth/logout")},onSuccess:()=>{W.clear(),x("/admin/login")}});if(z.useEffect(()=>{!m&&(!(a!=null&&a.user)||a.user.role!=="admin")&&x("/admin/login")},[m,a,x]),m)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto space-y-6",children:[e.jsx(c,{className:"h-20 w-full bg-white/5"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(c,{className:"h-32 bg-white/5"}),e.jsx(c,{className:"h-32 bg-white/5"}),e.jsx(c,{className:"h-32 bg-white/5"})]})]})});if(!(a!=null&&a.user)||a.user.role!=="admin")return null;const l=(h==null?void 0:h.tenants)||[],s=o==null?void 0:o.analytics,M=(s==null?void 0:s.tenants.byStatus.active)||l.filter(t=>t.status==="active").length,q=(s==null?void 0:s.tenants.byStatus.pending)||l.filter(t=>t.status==="pending").length;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900",children:[e.jsx("header",{className:"border-b border-white/10 bg-white/5 backdrop-blur-lg sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/20 rounded-xl flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-white",children:"Scholar.name Admin"}),e.jsxs("p",{className:"text-sm text-slate-400",children:["Welcome, ",a.user.firstName]})]})]}),e.jsxs(v,{variant:"ghost",size:"sm",onClick:()=>L.mutate(),className:"text-slate-400 hover:text-white hover:bg-white/10","data-testid":"button-logout",children:[e.jsx(J,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})}),e.jsxs("main",{className:"max-w-6xl mx-auto px-4 py-8 space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsx(i,{className:"bg-white/5 border-white/10",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Total Customers"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:l.length}),s!=null&&s.tenants.newThisMonth?e.jsxs("p",{className:"text-xs text-green-400 mt-1 flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),"+",s.tenants.newThisMonth," this month"]}):null]}),e.jsx("div",{className:"w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center",children:e.jsx(K,{className:"w-6 h-6 text-blue-400"})})]})})}),e.jsx(i,{className:"bg-white/5 border-white/10",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Active Sites"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:M})]}),e.jsx("div",{className:"w-12 h-12 bg-green-500/20 rounded-xl flex items-center justify-center",children:e.jsx(P,{className:"w-6 h-6 text-green-400"})})]})})}),e.jsx(i,{className:"bg-white/5 border-white/10",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Pending Setup"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:q})]}),e.jsx("div",{className:"w-12 h-12 bg-yellow-500/20 rounded-xl flex items-center justify-center",children:e.jsx(g,{className:"w-6 h-6 text-yellow-400"})})]})})}),e.jsx(i,{className:"bg-white/5 border-white/10",children:e.jsx(r,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Total Users"}),e.jsx("p",{className:"text-3xl font-bold text-white",children:(s==null?void 0:s.users.total)||0}),s!=null&&s.users.newThisMonth?e.jsxs("p",{className:"text-xs text-green-400 mt-1 flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),"+",s.users.newThisMonth," this month"]}):null]}),e.jsx("div",{className:"w-12 h-12 bg-purple-500/20 rounded-xl flex items-center justify-center",children:e.jsx(S,{className:"w-6 h-6 text-purple-400"})})]})})})]}),s&&e.jsxs(i,{className:"bg-white/5 border-white/10",children:[e.jsx(R,{children:e.jsxs(H,{className:"text-white flex items-center gap-2",children:[e.jsx(Q,{className:"w-5 h-5 text-slate-400"}),"Subscription Distribution"]})}),e.jsx(r,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-blue-500/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-blue-300 mb-1",children:"Starter"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.tenants.byPlan.starter}),e.jsx("div",{className:"w-full bg-blue-900/50 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${l.length?s.tenants.byPlan.starter/l.length*100:0}%`}})})]}),e.jsxs("div",{className:"bg-purple-500/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-purple-300 mb-1",children:"Professional"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.tenants.byPlan.professional}),e.jsx("div",{className:"w-full bg-purple-900/50 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-purple-500 h-2 rounded-full",style:{width:`${l.length?s.tenants.byPlan.professional/l.length*100:0}%`}})})]}),e.jsxs("div",{className:"bg-amber-500/10 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-amber-300 mb-1",children:"Institution"}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.tenants.byPlan.institution}),e.jsx("div",{className:"w-full bg-amber-900/50 rounded-full h-2 mt-2",children:e.jsx("div",{className:"bg-amber-500 h-2 rounded-full",style:{width:`${l.length?s.tenants.byPlan.institution/l.length*100:0}%`}})})]})]})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Quick Actions"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(n,{href:"/admin/users",children:e.jsx(i,{className:"bg-white/5 border-white/10 hover:bg-white/10 transition-colors cursor-pointer","data-testid":"link-users",children:e.jsx(r,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500/20 rounded-xl flex items-center justify-center",children:e.jsx(S,{className:"w-5 h-5 text-blue-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-white",children:"User Management"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Manage platform users"})]}),e.jsx(d,{className:"w-5 h-5 text-slate-500"})]})})})}),e.jsx(n,{href:"/admin/themes",children:e.jsx(i,{className:"bg-white/5 border-white/10 hover:bg-white/10 transition-colors cursor-pointer","data-testid":"link-themes",children:e.jsx(r,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-xl flex items-center justify-center",children:e.jsx(Z,{className:"w-5 h-5 text-purple-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-white",children:"Theme Management"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Customize portfolio color themes"})]}),e.jsx(d,{className:"w-5 h-5 text-slate-500"})]})})})}),e.jsx(n,{href:"/admin/tenants/new",children:e.jsx(i,{className:"bg-white/5 border-white/10 hover:bg-white/10 transition-colors cursor-pointer","data-testid":"button-new-tenant",children:e.jsx(r,{className:"py-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500/20 rounded-xl flex items-center justify-center",children:e.jsx(k,{className:"w-5 h-5 text-orange-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-white",children:"New Customer"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Create a new customer site"})]}),e.jsx(d,{className:"w-5 h-5 text-slate-500"})]})})})})]}),e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Customer Sites"})}),T?e.jsx("div",{className:"space-y-4",children:[1,2,3].map(t=>e.jsx(c,{className:"h-24 bg-white/5"},t))}):l.length===0?e.jsx(i,{className:"bg-white/5 border-white/10",children:e.jsxs(r,{className:"py-12 text-center",children:[e.jsx(y,{className:"w-12 h-12 text-slate-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-white mb-2",children:"No customers yet"}),e.jsx("p",{className:"text-slate-400 mb-4",children:"Create your first customer site to get started"}),e.jsx(n,{href:"/admin/tenants/new",children:e.jsxs(v,{className:"bg-orange-500 hover:bg-orange-600",children:[e.jsx(k,{className:"w-4 h-4 mr-2"}),"Create First Customer"]})})]})}):e.jsx("div",{className:"space-y-4",children:l.map(t=>{var N,b,f,w;const U=((N=u[t.status])==null?void 0:N.icon)||g,$=((b=u[t.status])==null?void 0:b.color)||"text-slate-400",A=((f=u[t.status])==null?void 0:f.bg)||"bg-slate-500/10",p=t.domains.find(B=>B.isPrimary)||t.domains[0];return e.jsx(n,{href:`/admin/tenants/${t.id}`,children:e.jsx(i,{className:"bg-white/5 border-white/10 hover:bg-white/10 transition-colors cursor-pointer","data-testid":`card-tenant-${t.id}`,children:e.jsx(r,{className:"py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 ${A} rounded-xl flex items-center justify-center`,children:e.jsx(U,{className:`w-5 h-5 ${$}`})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-medium text-white",children:t.name}),e.jsx(G,{className:D[t.plan]||"bg-slate-500/20 text-slate-300",children:t.plan})]}),e.jsxs("div",{className:"flex items-center gap-3 text-sm text-slate-400",children:[p?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),p.hostname]}):e.jsx("span",{className:"text-orange-400",children:"No domain assigned"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[t.users.length," user(s)"]}),((w=t.profile)==null?void 0:w.openalexId)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{className:"text-green-400",children:"OpenAlex configured"})]})]})]})]}),e.jsx(d,{className:"w-5 h-5 text-slate-500"})]})})})},t.id)})})]})]})}export{oe as default};
