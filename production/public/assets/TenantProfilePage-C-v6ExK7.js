import{u as U,j as e}from"./vendor-query-CD7Z7DR7.js";import{E as T,G as z,N as w,S as F,a as $,d as M,b as Y,c as E,C as v,L as G,R as B,P as K,M as W}from"./index-DxYk1RK-.js";import{t as D,C as I,k as O,S as X,r as q,q as A}from"./index-BFuOI41r.js";import{S as k}from"./skeleton-CQj4WJ4y.js";import{r as C}from"./vendor-react-DHpf67ko.js";import{R as H,g as V,C as Q,X as J,Y as R,T as Z,L as ee,d as te,h as se}from"./vendor-charts-4dyn6-nb.js";import{B as ae}from"./building-2-Btp-hdxb.js";import{M as ie}from"./mail-Dz_RMDNW.js";import{D as re}from"./download-BcB9j1QT.js";import{E as le}from"./external-link-CyUkBWug.js";import{F as ne}from"./file-text-CKkxYd6W.js";import"./award-DT8q0FSK.js";import"./select-BIBdjGVc.js";import"./index-B1CoDt99.js";import"./Combination-DEHEw_It.js";import"./index-CyvUQtII.js";import"./separator-DHxV4vh5.js";import"./dialog-p-zJK_Yk.js";import"./star-BR92FTcy.js";import"./database-DzSt1wQ7.js";import"./user-DfsljINI.js";function oe(){return{primary:"#0B1F3A",accent:"#F2994A",sage:"#7AA874",purple:"#6b21a8",rose:"#e11d48",teal:"#0d9488"}}function ce({openalexId:a,researcherData:l,inline:p=!1}){const t=C.useMemo(()=>oe(),[]),{data:s,isLoading:b}=U({queryKey:[`/api/researcher/${a}/data`],retry:!1,enabled:!l}),r=l||s,o=C.useMemo(()=>{if(!(r!=null&&r.publications)||r.publications.length===0)return{impactData:[],totalPublications:0,totalCitations:0,yearRange:{start:0,end:0}};const i=r.publications,h=new Date().getFullYear(),c={},d={};let m=0;i.forEach(x=>{const u=x.publicationYear||h;c[u]=(c[u]||0)+1;const f=x.citationCount||0;d[u]=(d[u]||0)+f,m+=f});const n=Math.min(...Object.keys(c).map(Number)),P=Math.max(...Object.keys(c).map(Number)),S=[];let j=0,y=0,L=0,_=0;for(let x=n;x<=P;x++){const u=c[x]||0,f=d[x]||0;L=j,_=y,j+=u,y+=f,S.push({year:x,cumulativePubs:j,cumulativeCitations:y,yearlyPubs:u,yearlyCitations:f,pubsDelta:j-L,citationsDelta:y-_})}return{impactData:S,totalPublications:i.length,totalCitations:m,yearRange:{start:n,end:P}}},[r]);if(b)return e.jsxs("div",{"data-testid":"section-analytics-loading",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx(k,{className:"h-6 w-48 mx-auto mb-2"}),e.jsx(k,{className:"h-4 w-64 mx-auto"})]}),e.jsx(k,{className:"h-[300px] w-full rounded-lg"})]});if(o.totalPublications===0)return e.jsx(T,{"data-testid":"section-analytics-empty",icon:D,title:"No Publication Data",description:"Analytics will appear once publication data is synchronized."});const N=({active:i,payload:h,label:c})=>{var d,m;if(i&&h&&h.length){const n=(d=h[0])==null?void 0:d.payload;return e.jsxs("div",{className:"bg-white/80 dark:bg-midnight/60 backdrop-blur-xl border border-platinum dark:border-white/20 rounded-lg p-3 shadow-xl min-w-[180px]",children:[e.jsx("p",{className:"font-bold text-base mb-2 border-b pb-1 text-midnight dark:text-white",children:c}),e.jsxs("div",{className:"space-y-1.5 text-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{style:{color:t.primary},children:"Publications:"}),e.jsx("span",{className:"font-semibold",children:n==null?void 0:n.yearlyPubs})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{style:{color:t.accent},children:"Cumulative Citations:"}),e.jsx("span",{className:"font-semibold",children:(m=n==null?void 0:n.cumulativeCitations)==null?void 0:m.toLocaleString()})]}),(n==null?void 0:n.yearlyCitations)>0&&e.jsxs("div",{className:"text-xs text-muted-foreground pl-2",children:["+",n.yearlyCitations.toLocaleString()," citations this year"]})]})]})}return null},g=e.jsxs("div",{className:"space-y-4",children:[!p&&e.jsxs("div",{className:"text-center mb-4",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold mb-1",children:"Research Impact"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Publication output and citation growth over ",o.yearRange.end-o.yearRange.start+1," years"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-2",children:[e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-foreground",children:o.totalPublications.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Works"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-foreground",children:o.totalCitations.toLocaleString()}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Total Citations"})]}),e.jsxs("div",{className:"text-center p-3 bg-muted/50 rounded-lg",children:[e.jsx("div",{className:"text-lg font-bold text-foreground",children:o.yearRange.end-o.yearRange.start+1}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Active Years"})]})]}),e.jsx(I,{className:"overflow-hidden","data-testid":"card-impact-chart",children:e.jsxs(O,{className:"p-3 sm:p-6",children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-3 font-medium",children:"Publications per year & cumulative citations"}),e.jsx(H,{width:"100%",height:320,children:e.jsxs(V,{data:o.impactData,margin:{top:20,right:20,left:0,bottom:5},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"gradientPubs",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:t.primary,stopOpacity:.8}),e.jsx("stop",{offset:"95%",stopColor:t.primary,stopOpacity:.3})]})}),e.jsx(Q,{strokeDasharray:"3 3",className:"opacity-30"}),e.jsx(J,{dataKey:"year",tick:{fontSize:11},tickFormatter:i=>`'${String(i).slice(-2)}`}),e.jsx(R,{yAxisId:"left",tick:{fontSize:11},width:45,tickFormatter:i=>i>=1e3?`${(i/1e3).toFixed(0)}k`:i,label:{value:"Pubs/Year",angle:-90,position:"insideLeft",style:{fontSize:11,fill:t.primary}}}),e.jsx(R,{yAxisId:"right",orientation:"right",tick:{fontSize:11},width:50,tickFormatter:i=>i>=1e3?`${(i/1e3).toFixed(0)}k`:i,label:{value:"Citations",angle:90,position:"insideRight",style:{fontSize:11,fill:t.accent}}}),e.jsx(Z,{content:e.jsx(N,{})}),e.jsx(ee,{wrapperStyle:{fontSize:"12px",paddingTop:"10px"},formatter:i=>e.jsx("span",{className:"text-foreground",children:i})}),e.jsx(te,{yAxisId:"left",dataKey:"yearlyPubs",fill:"url(#gradientPubs)",radius:[4,4,0,0],name:"Publications / Year",maxBarSize:40}),e.jsx(se,{yAxisId:"right",type:"monotone",dataKey:"cumulativeCitations",stroke:t.accent,strokeWidth:3,dot:{fill:t.accent,strokeWidth:0,r:3},activeDot:{r:6,fill:t.accent},name:"Total Citations"})]})})]})})]});return p?e.jsx("div",{"data-testid":"section-analytics",children:g}):e.jsx("section",{id:"analytics",className:"py-6","data-testid":"section-analytics",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g})})}function de(a){return z({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M389.2 48h70.6L305.6 224.2 487 464H345L233.7 318.6 106.5 464H35.8L200.7 275.5 26.8 48H172.4L272.9 180.9 389.2 48zM364.4 421.8h39.1L151.1 88h-42L364.4 421.8z"},child:[]}]})(a)}function me(a){if(!a)return"?";const l=a.split(" ").filter(Boolean);return l.length===1?l[0].charAt(0).toUpperCase():(l[0].charAt(0)+l[l.length-1].charAt(0)).toUpperCase()}function xe(a){const l=["from-blue-500 to-blue-600","from-purple-500 to-purple-600","from-emerald-500 to-emerald-600","from-amber-500 to-amber-600","from-rose-500 to-rose-600","from-cyan-500 to-cyan-600","from-indigo-500 to-indigo-600","from-teal-500 to-teal-600"],p=a.split("").reduce((t,s)=>t+s.charCodeAt(0),0);return l[p%l.length]}function Ie(){var c,d,m;const{data:a,isLoading:l,error:p}=U({queryKey:["/api/profile"],retry:!1}),t=a==null?void 0:a.profile,s=a==null?void 0:a.researcher,b=a==null?void 0:a.tenant,r=(t==null?void 0:t.openalexId)||"",o=t?`${t.displayName||(s==null?void 0:s.display_name)} - Research Profile`:"Research Profile",N=(t==null?void 0:t.bio)||(s?`${(t==null?void 0:t.displayName)||s.display_name} - ${(s==null?void 0:s.works_count)||0} publications, ${(s==null?void 0:s.cited_by_count)||0} citations`:"Research Profile"),g=typeof window<"u"?window.location.href:"",i=(t==null?void 0:t.profileImageUrl)||"https://images.unsplash.com/photo-1582750433449-648ed127bb54?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&h=500",h=C.useMemo(()=>t?{"@context":"https://schema.org","@type":"Person",name:t.displayName||(s==null?void 0:s.display_name),description:t.bio||`Researcher with ${(s==null?void 0:s.works_count)||0} publications`,jobTitle:t.title,url:g,image:i}:null,[t,s,g,i]);return l?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(w,{researcherName:"Loading..."}),e.jsxs("section",{className:"hero-banner-compact py-8 md:py-12 relative",children:[e.jsx("div",{className:"hero-pattern"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 md:gap-6",children:[e.jsx("div",{className:"w-20 h-20 md:w-28 md:h-28 rounded-full bg-white/20 animate-pulse flex-shrink-0"}),e.jsxs("div",{className:"text-center md:text-left space-y-2 flex-1",children:[e.jsx("div",{className:"h-7 md:h-9 bg-white/20 rounded-lg animate-pulse w-48 md:w-64 mx-auto md:mx-0"}),e.jsx("div",{className:"h-5 bg-white/15 rounded-lg animate-pulse w-36 md:w-48 mx-auto md:mx-0"}),e.jsxs("div",{className:"flex items-center justify-center md:justify-start gap-2 pt-2",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"text-white/70 text-xs font-medium",children:"Loading..."})]})]})]})})]})]}):p||!a||!a.profile?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(w,{researcherName:"Profile"}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:e.jsx(I,{children:e.jsx(O,{className:"pt-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Profile Not Configured"}),e.jsx("p",{className:"text-muted-foreground mb-8 max-w-2xl mx-auto",children:"This researcher profile hasn't been set up yet. Please log in to configure your OpenAlex ID."}),e.jsx("a",{href:"/dashboard/login",className:"inline-flex items-center justify-center px-6 py-3 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors",children:"Log In to Configure"})]})})})})]}):e.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0","data-testid":"page-tenant-profile",children:[e.jsx(X,{title:o,description:N,image:i,url:g,author:(t==null?void 0:t.displayName)||(s==null?void 0:s.display_name)||"Researcher",type:"profile",structuredData:h||void 0}),e.jsx(w,{researcherName:(t==null?void 0:t.displayName)||(s==null?void 0:s.display_name)||"Researcher"}),e.jsxs("section",{id:"overview",className:"hero-banner-compact py-6 md:py-10 relative",children:[e.jsx("div",{className:"hero-pattern"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 z-10",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center gap-4 md:gap-6 text-white",children:[e.jsx("div",{className:"flex-shrink-0",children:t!=null&&t.profileImageUrl?e.jsx("img",{src:t.profileImageUrl,alt:"Professional portrait",className:"w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full object-cover border-3 border-white/30 shadow-xl","data-testid":"img-profile-photo"}):e.jsx("div",{className:`w-20 h-20 sm:w-24 sm:h-24 md:w-28 md:h-28 rounded-full border-3 border-white/30 shadow-xl flex items-center justify-center bg-gradient-to-br ${xe((t==null?void 0:t.displayName)||(s==null?void 0:s.display_name)||"")}`,"data-testid":"img-profile-photo",children:e.jsx("span",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-white",children:me((t==null?void 0:t.displayName)||(s==null?void 0:s.display_name)||"")})})}),e.jsxs("div",{className:"flex-1 text-center md:text-left space-y-2",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-4xl font-bold mb-1","data-testid":"text-display-name",children:(t==null?void 0:t.displayName)||(s==null?void 0:s.display_name)||"Researcher Profile"}),e.jsx("p",{className:"text-sm sm:text-base md:text-lg text-white/90","data-testid":"text-title",children:(t==null?void 0:t.title)||"Research Professional"})]}),e.jsx("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-2 text-xs sm:text-sm text-white/80",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 bg-white/10 px-2.5 py-1 rounded-full",children:[e.jsx(ae,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"truncate max-w-[200px] md:max-w-none","data-testid":"text-affiliation",children:(t==null?void 0:t.currentAffiliation)||((d=(c=s==null?void 0:s.last_known_institutions)==null?void 0:c[0])==null?void 0:d.display_name)||"Institution"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center md:justify-start gap-1.5",children:[(t==null?void 0:t.orcidUrl)&&e.jsx("a",{href:t.orcidUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"ORCID",children:e.jsx(F,{className:"w-4 h-4"})}),(t==null?void 0:t.googleScholarUrl)&&e.jsx("a",{href:t.googleScholarUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"Google Scholar",children:e.jsx($,{className:"w-4 h-4"})}),(t==null?void 0:t.researchGateUrl)&&e.jsx("a",{href:t.researchGateUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"ResearchGate",children:e.jsx(M,{className:"w-4 h-4"})}),(t==null?void 0:t.linkedinUrl)&&e.jsx("a",{href:t.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"LinkedIn",children:e.jsx(Y,{className:"w-4 h-4"})}),(t==null?void 0:t.websiteUrl)&&e.jsx("a",{href:t.websiteUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"Website",children:e.jsx(q,{className:"w-4 h-4"})}),(t==null?void 0:t.twitterUrl)&&e.jsx("a",{href:t.twitterUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2 rounded-full bg-white/10 hover:bg-white/20 transition-colors",title:"X (Twitter)",children:e.jsx(de,{className:"w-4 h-4"})}),((t==null?void 0:t.contactEmail)||(t==null?void 0:t.email))&&e.jsxs("a",{href:`mailto:${t.contactEmail||t.email}`,className:"ml-1 inline-flex items-center gap-1.5 bg-white text-primary px-3 py-1.5 rounded-full text-xs sm:text-sm font-medium hover:bg-white/90 transition-colors","data-testid":"link-contact",children:[e.jsx(ie,{className:"w-3.5 h-3.5"}),"Contact"]})]})]})]})})]}),((t==null?void 0:t.bio)||(t==null?void 0:t.cvUrl)||r)&&e.jsx("section",{className:"py-6 md:py-10 bg-muted/50 border-b border-border",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 md:gap-10",children:[(t==null?void 0:t.bio)&&e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wider mb-2",children:"About"}),e.jsx("p",{className:"text-sm md:text-base text-foreground leading-relaxed","data-testid":"text-bio",children:t.bio})]}),e.jsxs("div",{className:"flex flex-wrap md:flex-col gap-2 md:gap-3",children:[(t==null?void 0:t.cvUrl)&&t.cvUrl!=="#cv-placeholder"&&e.jsxs("a",{href:t.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-primary hover:text-primary/80 transition-colors","data-testid":"link-cv",children:[e.jsx(re,{className:"w-4 h-4"}),"Download CV"]}),r&&e.jsxs("a",{href:`https://openalex.org/authors/${r}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 text-sm text-primary hover:text-primary/80 transition-colors","data-testid":"link-openalex",children:[e.jsx(le,{className:"w-4 h-4"}),"View on OpenAlex"]})]})]})})}),e.jsx(E,{openalexId:r}),e.jsx(v,{id:"analytics",title:"Publication Analytics",icon:e.jsx(D,{className:"w-5 h-5 md:w-6 md:h-6"}),defaultOpen:!0,mobileDefaultOpen:!1,className:"bg-background",children:e.jsx(ce,{openalexId:r,researcherData:a,inline:!0})}),e.jsx(v,{id:"research",title:"Research Areas",icon:e.jsx(G,{className:"w-5 h-5 md:w-6 md:h-6"}),defaultOpen:!0,mobileDefaultOpen:!1,className:"bg-muted",badge:(m=a==null?void 0:a.topics)!=null&&m.length?e.jsx(A,{variant:"secondary",className:"ml-2",children:a.topics.length}):null,children:e.jsx(B,{openalexId:r,inline:!0})}),e.jsx(v,{id:"publications",title:"Publications",icon:e.jsx(ne,{className:"w-5 h-5 md:w-6 md:h-6"}),defaultOpen:!0,mobileDefaultOpen:!1,className:"bg-background",badge:s!=null&&s.works_count?e.jsx(A,{variant:"secondary",className:"ml-2",children:s.works_count}):null,children:e.jsx(K,{openalexId:r,inline:!0})}),e.jsx("footer",{className:"bg-gradient-to-br from-card to-muted/20 border-t border-border py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("p",{className:"text-muted-foreground/70 text-sm",children:["Â© ",new Date().getFullYear()," ",(b==null?void 0:b.name)||"Scholar.name",". Powered by Scholar.name."]}),(a==null?void 0:a.lastSynced)&&e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:["Last updated: ",new Date(a.lastSynced).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})]})]})})}),e.jsx(W,{})]})}export{Ie as default};
