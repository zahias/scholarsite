import{u as N,a as b,r as d,j as e,l as y,e as i,C as v,f as C,aj as F,g as S,h as E,d as P,I as m,Q as k,ai as L,m as T}from"./index-DsMkGSNQ.js";import{u as I}from"./useMutation-BIiySL2y.js";import{u as O,F as M,a as x,b as u,c as h,d as j,e as p,z as l,t as A}from"./form-DwDJHa6e.js";import{A as B}from"./arrow-left-VC8VMkdm.js";import{a as G,E as H}from"./eye-DWE8iN3r.js";import"./label-DBXjDKEQ.js";const R=l.object({email:l.string().email("Please enter a valid email address"),password:l.string().min(1,"Password is required")});function V(){const[,r]=N(),{toast:c}=b(),[o,f]=d.useState(!1);d.useEffect(()=>{window.scrollTo(0,0)},[]);const t=O({resolver:A(R),defaultValues:{email:"",password:""}}),n=I({mutationFn:async s=>{const a=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok){const w=await a.json();throw new Error(w.message||"Login failed")}return a.json()},onSuccess:s=>{var a;c({title:"Welcome back!",description:"Redirecting to your dashboard..."}),((a=s.user)==null?void 0:a.role)==="admin"?r("/admin"):r("/dashboard")},onError:s=>{c({title:"Login failed",description:s.message,variant:"destructive"})}}),g=s=>{n.mutate(s)};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[e.jsx(y,{mode:"auth"}),e.jsxs("div",{className:"flex-1 max-w-md mx-auto w-full px-4 py-12",children:[e.jsxs(i,{variant:"ghost",className:"mb-6",onClick:()=>r("/"),children:[e.jsx(B,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),e.jsxs(v,{children:[e.jsxs(C,{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center mx-auto mb-4",children:e.jsx(F,{className:"w-6 h-6 text-primary"})}),e.jsx(S,{className:"text-2xl",children:"Welcome back"}),e.jsx(E,{children:"Sign in to manage your research portfolio"})]}),e.jsx(P,{children:e.jsx(M,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(g),className:"space-y-4",children:[e.jsx(x,{control:t.control,name:"email",render:({field:s})=>e.jsxs(u,{children:[e.jsx(h,{children:"Email"}),e.jsx(j,{children:e.jsx(m,{type:"email",placeholder:"jane.smith@university.edu",autoComplete:"email",...s})}),e.jsx(p,{})]})}),e.jsx(x,{control:t.control,name:"password",render:({field:s})=>e.jsxs(u,{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(h,{children:"Password"}),e.jsx("a",{href:"/forgot-password",className:"text-xs text-primary hover:underline",children:"Forgot password?"})]}),e.jsx(j,{children:e.jsxs("div",{className:"relative",children:[e.jsx(m,{type:o?"text":"password",placeholder:"••••••••",autoComplete:"current-password",...s}),e.jsx("button",{type:"button",onClick:()=>f(!o),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:o?e.jsx(G,{className:"w-4 h-4"}):e.jsx(H,{className:"w-4 h-4"})})]})}),e.jsx(p,{})]})}),e.jsx(i,{type:"submit",className:"w-full btn-premium py-6",disabled:n.isPending,children:n.isPending?e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"w-4 h-4 mr-2 animate-spin"}),"Signing in..."]}):"Sign in"})]})})}),e.jsxs(L,{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("span",{className:"w-full border-t"})}),e.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:e.jsx("span",{className:"bg-card px-2 text-muted-foreground",children:"Or"})})]}),e.jsx(i,{variant:"outline",className:"w-full",onClick:()=>r("/signup"),children:"Create a new account"})]})]}),e.jsxs("p",{className:"text-center text-sm text-muted-foreground mt-6",children:["Need help?"," ",e.jsx("a",{href:"/contact",className:"text-primary hover:underline",children:"Contact support"})]})]}),e.jsx(T,{mode:"landing"})]})}export{V as default};
