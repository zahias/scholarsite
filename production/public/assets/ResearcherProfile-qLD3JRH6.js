import{j as e,u as oe}from"./vendor-query-CD7Z7DR7.js";import{c as B,C as E,l as ze,m as $e,k as I,F as le,y as Ue,o as Ye,p as Y,U as qe,a as Be,z as ce,D as de,u as me,P as ue,b as M,d as xe,E as We,H as Ve,J as Ge,K as De,N as Ke,g as He,O as Qe,h as Xe,B as q,w as Je,j as Ze,Q as Z,T as pe,i as et,S as tt}from"./index-ADePB-jF.js";import{L as he,E as fe,R as st,Q as at,N as W,S as rt,a as it,b as nt,c as ot,C as ee,P as lt,M as ct}from"./index-CiZumnF3.js";import{A as ge}from"./award-BTIcl_QY.js";import{r as h}from"./vendor-react-DHpf67ko.js";import{T as dt,a as mt,b as $,c as U,Q as te}from"./tabs-BeVFlCbO.js";import{S as se}from"./skeleton-BxqIcbk8.js";import{T as be}from"./trending-up-zUzUbM-T.js";import{R as D,A as ut,C as je,X as ve,Y as V,T as K,L as xt,a as pt,b as ae,B as ht,d as ft,e as ye,P as gt,f as bt}from"./vendor-charts-4dyn6-nb.js";import{h as jt,R as vt,u as yt,F as wt}from"./Combination-CGLXVail.js";import{u as Nt}from"./index-kJK_MUWg.js";import{u as we,n as Ne,P as kt,g as Ct}from"./ThemeContext-XKB-XyJ8.js";import{P as re}from"./palette-DrK6OaHh.js";import{D as Pt,a as St,b as Rt,c as _t,d as At}from"./dialog-WwBiQRpy.js";import{D as G}from"./download-VZR_G78m.js";import{B as Tt}from"./building-2-DXlZPpxJ.js";import{E as Ot}from"./external-link-DLIM7sQR.js";import{U as Et}from"./user-X63Yn1rZ.js";import"./select-DP3uqzmb.js";import"./index-B1CoDt99.js";import"./chevron-up-oOAvqpdg.js";import"./separator-8g90Hkn1.js";import"./star-C7Ary89g.js";import"./database-ZClfk9KX.js";import"./index-DbRr6nNw.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=B("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const It=B("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ke=B("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=B("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);function Lt(a){switch(a){case"research_interests":return e.jsx(he,{className:"w-5 h-5"});case"awards":return e.jsx(ge,{className:"w-5 h-5"});case"teaching":return e.jsx(Ue,{className:"w-5 h-5"});case"grants":return e.jsx(It,{className:"w-5 h-5"});default:return e.jsx(le,{className:"w-5 h-5"})}}function Mt(a){switch(a){case"research_interests":return{bg:"bg-blue-500/10",text:"text-blue-600",border:"border-blue-500/20"};case"awards":return{bg:"bg-amber-500/10",text:"text-amber-600",border:"border-amber-500/20"};case"teaching":return{bg:"bg-green-500/10",text:"text-green-600",border:"border-green-500/20"};case"grants":return{bg:"bg-purple-500/10",text:"text-purple-600",border:"border-purple-500/20"};default:return{bg:"bg-slate-500/10",text:"text-slate-600",border:"border-slate-500/20"}}}function zt(a){return a.split(`
`).map((r,t)=>{if(r.startsWith("### "))return e.jsx("h4",{className:"font-semibold text-lg mt-4 mb-2",children:r.slice(4)},t);if(r.startsWith("## "))return e.jsx("h3",{className:"font-semibold text-xl mt-4 mb-2",children:r.slice(3)},t);if(r.startsWith("# "))return e.jsx("h2",{className:"font-bold text-2xl mt-4 mb-2",children:r.slice(2)},t);if(r.startsWith("- ")||r.startsWith("* "))return e.jsx("li",{className:"ml-4 list-disc text-muted-foreground",children:r.slice(2)},t);const m=r.match(/^\d+\.\s/);if(m)return e.jsx("li",{className:"ml-4 list-decimal text-muted-foreground",children:r.slice(m[0].length)},t);if(r.trim()==="")return e.jsx("br",{},t);const l=r.split(/(\*\*.*?\*\*|\*.*?\*|_.*?_)/g);return e.jsx("p",{className:"text-muted-foreground mb-2",children:l.map((n,d)=>n.startsWith("**")&&n.endsWith("**")?e.jsx("strong",{children:n.slice(2,-2)},d):n.startsWith("*")&&n.endsWith("*")||n.startsWith("_")&&n.endsWith("_")?e.jsx("em",{children:n.slice(1,-1)},d):n)},t)})}function $t({sections:a}){if(!a||a.length===0)return null;const o=[...a].sort((r,t)=>r.sortOrder-t.sortOrder);return e.jsx("section",{className:"py-12 bg-muted/30",id:"about",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:o.map(r=>{const t=Mt(r.sectionType);return e.jsxs(E,{className:`border ${t.border} shadow-sm hover:shadow-md transition-shadow`,children:[e.jsx(ze,{className:"pb-3",children:e.jsxs($e,{className:"flex items-center gap-3 text-lg",children:[e.jsx("div",{className:`w-10 h-10 ${t.bg} rounded-lg flex items-center justify-center ${t.text}`,children:Lt(r.sectionType)}),e.jsx("span",{children:r.title})]})}),e.jsx(I,{children:e.jsx("div",{className:"prose prose-sm max-w-none",children:zt(r.content)})})]},r.id)})})})})}function Ut(){if(typeof window>"u")return{primary:"#1e3a5f",accent:"#c9a227",primaryLight:"#2a4d6e"};const a=getComputedStyle(document.documentElement);return{primary:a.getPropertyValue("--theme-primary").trim()||"#1e3a5f",accent:a.getPropertyValue("--theme-accent").trim()||"#c9a227",primaryLight:a.getPropertyValue("--theme-primary").trim()||"#1e3a5f"}}function Yt({openalexId:a,researcherData:o,inline:r=!1}){var p,P,N;const t=h.useMemo(()=>Ut(),[]),{data:m,isLoading:l}=oe({queryKey:[`/api/researcher/${a}/data`],retry:!1,enabled:!o}),n=o||m,d=h.useMemo(()=>{var y,R;const u=n==null?void 0:n.researcher,b=(u==null?void 0:u.counts_by_year)||[];if(b.length===0){const f=(n==null?void 0:n.publications)||[];if(f.length===0)return{data:[],milestones:[],careerStart:null,peakYear:null,totalYears:0,avgPubsPerYear:0};const x={};f.forEach(_=>{const S=_.publicationYear||new Date().getFullYear();x[S]||(x[S]={works:0,citations:0}),x[S].works+=1,x[S].citations+=_.citationCount||0});const w=Object.keys(x).map(Number).sort((_,S)=>_-S),k=Math.min(...w),O=Math.max(...w),L=[];let X=0,J=0;for(let _=k;_<=O;_++){const S=x[_]||{works:0,citations:0};X+=S.works,J+=S.citations,L.push({year:_,publications:S.works,citations:S.citations,cumulativePublications:X,cumulativeCitations:J})}return s(L,k,O)}const v=[...b].sort((f,x)=>f.year-x.year),c=(y=v[0])==null?void 0:y.year,g=(R=v[v.length-1])==null?void 0:R.year,j=[];let A=0,C=0;for(let f=c;f<=g;f++){const x=v.find(O=>O.year===f),w=(x==null?void 0:x.works_count)||0,k=(x==null?void 0:x.cited_by_count)||0;A+=w,C+=k,j.push({year:f,publications:w,citations:k,cumulativePublications:A,cumulativeCitations:C})}return s(j,c,g)},[n]);function s(u,b,v){if(u.length===0)return{data:[],milestones:[],careerStart:null,peakYear:null,totalYears:0,avgPubsPerYear:0};const c=[],g=u.find(f=>f.publications>0);g&&c.push({year:g.year,type:"first_publication",label:"Career Start"});const j=u.reduce((f,x)=>x.publications>((f==null?void 0:f.publications)||0)?x:f,u[0]);j&&j.publications>0&&c.push({year:j.year,type:"peak_year",label:`Peak Year (${j.publications} pubs)`,value:j.publications}),[100,500,1e3,5e3,1e4].forEach(f=>{const x=u.find(k=>k.cumulativeCitations>=f),w=u.find(k=>k.year===(x==null?void 0:x.year)-1);x&&(!w||w.cumulativeCitations<f)&&c.push({year:x.year,type:"citation_milestone",label:`${f.toLocaleString()} Citations`,value:f})});const C=u.reduce((f,x)=>f+x.publications,0),y=v-b+1,R=y>0?(C/y).toFixed(1):0;return{data:u,milestones:c.slice(0,4),careerStart:b,peakYear:j==null?void 0:j.year,totalYears:y,avgPubsPerYear:R}}const i=({active:u,payload:b,label:v})=>{if(u&&b&&b.length){const c=b[0].payload,g=t;return e.jsxs("div",{className:"bg-background/95 backdrop-blur-sm border border-border rounded-lg shadow-lg p-3 text-sm",children:[e.jsx("p",{className:"font-semibold text-foreground mb-2",children:v}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:g.primary}}),e.jsx("span",{className:"text-muted-foreground",children:"Publications:"}),e.jsx("span",{className:"font-medium",children:c.publications}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(total: ",c.cumulativePublications,")"]})]}),e.jsxs("p",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"w-3 h-3 rounded-full",style:{backgroundColor:g.accent}}),e.jsx("span",{className:"text-muted-foreground",children:"Citations:"}),e.jsx("span",{className:"font-medium",children:c.citations.toLocaleString()}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:["(total: ",c.cumulativeCitations.toLocaleString(),")"]})]})]})]})}return null};return l?e.jsxs("div",{"data-testid":"section-timeline-loading",children:[e.jsx("div",{className:"flex items-center gap-4 mb-6",children:[...Array(4)].map((u,b)=>e.jsx(se,{className:"h-20 flex-1 rounded-lg"},b))}),e.jsx(se,{className:"h-[280px] w-full rounded-lg"})]}):d.data.length===0?e.jsx(fe,{"data-testid":"section-timeline-empty",icon:ie,title:"No Timeline Data",description:"Career timeline will appear once publication data is available."}):e.jsxs("div",{"data-testid":"section-career-timeline",className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx(E,{className:"bg-gradient-to-br from-primary/5 to-primary/10 border-primary/20",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ie,{className:"w-4 h-4 text-primary"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Career Span"})]}),e.jsxs("p",{className:"text-2xl font-bold text-primary",children:[d.totalYears," years"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[d.careerStart," ‚Äì ",(p=d.data[d.data.length-1])==null?void 0:p.year]})]})}),d.peakYear&&e.jsx(E,{className:"bg-gradient-to-br from-accent/5 to-accent/10 border-accent/20",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ge,{className:"w-4 h-4 text-accent"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Peak Year"})]}),e.jsx("p",{className:"text-2xl font-bold text-accent",children:d.peakYear}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Most productive year"})]})}),e.jsx(E,{className:"bg-gradient-to-br from-emerald-500/5 to-emerald-500/10 border-emerald-500/20",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(be,{className:"w-4 h-4 text-emerald-600"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Avg/Year"})]}),e.jsx("p",{className:"text-2xl font-bold text-emerald-600",children:d.avgPubsPerYear}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Publications per year"})]})}),d.milestones.length>1&&e.jsx(E,{className:"bg-gradient-to-br from-purple-500/5 to-purple-500/10 border-purple-500/20",children:e.jsxs(I,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ye,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Milestone"})]}),e.jsx("p",{className:"text-lg font-bold text-purple-600 leading-tight",children:(P=d.milestones[d.milestones.length-1])==null?void 0:P.label}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["in ",(N=d.milestones[d.milestones.length-1])==null?void 0:N.year]})]})})]}),e.jsx(E,{children:e.jsxs(I,{className:"p-4 md:p-6",children:[e.jsx("div",{className:"h-[280px] md:h-[320px]",children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(ut,{data:d.data,margin:{top:10,right:10,left:0,bottom:0},children:[e.jsxs("defs",{children:[e.jsxs("linearGradient",{id:"pubGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:t.primary,stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:t.primary,stopOpacity:.05})]}),e.jsxs("linearGradient",{id:"citeGradient",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:t.accent,stopOpacity:.4}),e.jsx("stop",{offset:"95%",stopColor:t.accent,stopOpacity:.05})]})]}),e.jsx(je,{strokeDasharray:"3 3",className:"stroke-muted",opacity:.3}),e.jsx(ve,{dataKey:"year",tick:{fontSize:11,fill:"currentColor"},tickLine:!1,axisLine:{stroke:"currentColor",opacity:.2},interval:"preserveStartEnd"}),e.jsx(V,{yAxisId:"left",tick:{fontSize:11,fill:"currentColor"},tickLine:!1,axisLine:{stroke:"currentColor",opacity:.2},width:35,label:{value:"Publications",angle:-90,position:"insideLeft",style:{fontSize:10,fill:t.primary}}}),e.jsx(V,{yAxisId:"right",orientation:"right",tick:{fontSize:11,fill:"currentColor"},tickLine:!1,axisLine:{stroke:"currentColor",opacity:.2},width:45,tickFormatter:u=>u>=1e3?`${(u/1e3).toFixed(0)}k`:u,label:{value:"Citations",angle:90,position:"insideRight",style:{fontSize:10,fill:t.accent}}}),e.jsx(K,{content:e.jsx(i,{})}),e.jsx(xt,{verticalAlign:"top",height:36,formatter:u=>e.jsx("span",{className:"text-sm text-foreground",children:u})}),d.milestones.filter(u=>u.type==="first_publication"||u.type==="peak_year").map((u,b)=>e.jsx(pt,{x:u.year,yAxisId:"left",stroke:u.type==="first_publication"?"#22c55e":"#f59e0b",strokeDasharray:"5 5",strokeWidth:1.5,label:{value:u.type==="first_publication"?"üöÄ":"‚≠ê",position:"top",fontSize:14}},b)),e.jsx(ae,{yAxisId:"left",type:"monotone",dataKey:"cumulativePublications",name:"Cumulative Publications",stroke:t.primary,strokeWidth:2,fill:"url(#pubGradient)",dot:!1,activeDot:{r:4,fill:t.primary}}),e.jsx(ae,{yAxisId:"right",type:"monotone",dataKey:"cumulativeCitations",name:"Cumulative Citations",stroke:t.accent,strokeWidth:2,fill:"url(#citeGradient)",dot:!1,activeDot:{r:4,fill:t.accent}})]})})}),e.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:e.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"üöÄ Career start ‚Ä¢ ‚≠ê Peak productivity year ‚Ä¢ Data from OpenAlex"})})]})})]})}function Ce(){if(typeof window>"u")return{primary:"#1e3a5f",accent:"#c9a227",sage:"#7AA874",platinum:"#E4E9F7"};const a=getComputedStyle(document.documentElement);return{primary:a.getPropertyValue("--theme-primary").trim()||"#0B1F3A",accent:a.getPropertyValue("--theme-accent").trim()||"#F2994A",sage:a.getPropertyValue("--theme-sage").trim()||"#7AA874",platinum:a.getPropertyValue("--theme-platinum").trim()||"#E4E9F7"}}function qt({publications:a,researcherName:o}){const r=h.useMemo(()=>Ce(),[]),t=h.useMemo(()=>{const l={},n=o.toLowerCase().trim();return a.forEach(d=>{d.authorNames&&d.authorNames.split(",").map(i=>i.trim()).forEach(i=>{if(!i)return;const p=i.toLowerCase();p.includes(n)||n.includes(p)||(l[p]||(l[p]={count:0,name:i}),l[p].count+=1)})}),Object.values(l).sort((d,s)=>s.count-d.count).slice(0,10)},[a,o]);if(t.length===0)return e.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[e.jsx(qe,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Not enough co-authorship data available."})]});const m=({active:l,payload:n})=>l&&n&&n.length?e.jsxs("div",{className:"bg-white/80 dark:bg-midnight/60 backdrop-blur-xl border border-platinum dark:border-white/20 rounded-lg p-3 shadow-xl",children:[e.jsx("p",{className:"font-bold text-sm text-midnight dark:text-white",children:n[0].payload.name}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.jsx("span",{className:"font-semibold text-warm",children:n[0].value})," co-authored publications"]})]}):null;return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"text-center max-w-2xl mx-auto mb-6",children:[e.jsxs("h3",{className:"text-xl font-serif font-bold text-midnight dark:text-white flex items-center justify-center gap-2",children:[e.jsx(ke,{className:"w-5 h-5 text-warm"})," Top Collaborators"]}),e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Frequent co-authors across ",a.length," publications"]})]}),e.jsx(E,{className:"bg-white/50 dark:bg-midnight/20 backdrop-blur-sm border-platinum dark:border-white/10 shadow-none",children:e.jsx(I,{className:"p-4 md:p-6",children:e.jsx("div",{className:"h-[300px]",children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(ht,{data:t,layout:"vertical",margin:{top:5,right:30,left:60,bottom:5},children:[e.jsx(je,{strokeDasharray:"3 3",horizontal:!0,vertical:!1,opacity:.2,stroke:"currentColor"}),e.jsx(ve,{type:"number",hide:!0}),e.jsx(V,{dataKey:"name",type:"category",axisLine:!1,tickLine:!1,tick:{fontSize:11,fill:"currentColor"},width:100}),e.jsx(K,{content:e.jsx(m,{}),cursor:{fill:"currentColor",opacity:.05}}),e.jsx(ft,{dataKey:"count",radius:[0,4,4,0],barSize:20,children:t.map((l,n)=>e.jsx(ye,{fill:n<3?r.accent:r.primary,fillOpacity:.8},`cell-${n}`))})]})})})})})]})}function Bt({publications:a}){const o=h.useMemo(()=>Ce(),[]),r=h.useMemo(()=>{const l={};return a.forEach(n=>{var s;const d=(s=n.journal)==null?void 0:s.trim();d&&(l[d]||(l[d]={count:0,name:d}),l[d].count+=1)}),Object.values(l).sort((n,d)=>d.count-n.count).slice(0,8)},[a]);if(r.length===0)return e.jsxs("div",{className:"py-12 text-center text-muted-foreground",children:[e.jsx(Y,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),e.jsx("p",{children:"Not enough venue data available."})]});const t=[o.primary,o.accent,o.sage,"#6b21a8","#0d9488","#e11d48","#3b82f6","#f59e0b"],m=({active:l,payload:n})=>l&&n&&n.length?e.jsxs("div",{className:"bg-white/80 dark:bg-midnight/60 backdrop-blur-xl border border-platinum dark:border-white/20 rounded-lg p-3 shadow-xl max-w-[250px] whitespace-normal",children:[e.jsx("p",{className:"font-bold text-sm text-midnight dark:text-white leading-tight mb-1",children:n[0].payload.name}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx("span",{className:"font-semibold",style:{color:n[0].payload.fill},children:n[0].value})," publications"]})]}):null;return e.jsxs("div",{className:"space-y-6 animate-in fade-in slide-in-from-bottom-4 duration-500",children:[e.jsxs("div",{className:"text-center max-w-2xl mx-auto mb-6",children:[e.jsxs("h3",{className:"text-xl font-serif font-bold text-midnight dark:text-white flex items-center justify-center gap-2",children:[e.jsx(Y,{className:"w-5 h-5 text-sage"})," Top Venues"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Most frequent journals and conferences"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 items-center",children:[e.jsx("div",{className:"h-[280px]",children:e.jsx(D,{width:"100%",height:"100%",children:e.jsxs(gt,{children:[e.jsx(bt,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:100,paddingAngle:2,dataKey:"count",stroke:"none",children:r.map((l,n)=>e.jsx(ye,{fill:t[n%t.length],fillOpacity:.85},`cell-${n}`))}),e.jsx(K,{content:e.jsx(m,{})})]})})}),e.jsx("div",{className:"space-y-3",children:r.map((l,n)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full flex-shrink-0 shadow-sm",style:{backgroundColor:t[n%t.length]}}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsx("p",{className:"text-sm font-medium text-foreground truncate",title:l.name,children:l.name})}),e.jsx("div",{className:"text-sm font-bold text-muted-foreground mx-2",children:l.count})]},n))})]})]})}function Wt({openalexId:a,researcherData:o,researcherName:r}){return e.jsx("section",{id:"insights",className:"py-8 md:py-16 bg-academic-motif relative scroll-mt-20",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h2",{className:"text-3xl font-serif font-bold text-midnight dark:text-white mb-3",children:"Research Insights"}),e.jsx("p",{className:"text-base text-muted-foreground max-w-2xl mx-auto",children:"Explore the trajectory, collaborations, and publishing patterns that define this research portfolio."})]}),e.jsx("div",{className:"bg-white/70 dark:bg-midnight/30 backdrop-blur-xl border border-platinum dark:border-white/10 rounded-2xl shadow-xl overflow-hidden",children:e.jsxs(dt,{defaultValue:"trajectory",className:"w-full",children:[e.jsx("div",{className:"bg-muted/30 border-b border-platinum dark:border-white/10 p-2 sm:p-4 pb-0 overflow-x-auto",children:e.jsxs(mt,{className:"bg-transparent space-x-2 h-auto p-0 min-w-max",children:[e.jsxs($,{value:"trajectory",className:"data-[state=active]:bg-white data-[state=active]:dark:bg-midnight/80 data-[state=active]:shadow-sm rounded-t-lg rounded-b-none border-b-2 border-transparent data-[state=active]:border-warm px-6 py-3 text-sm font-medium transition-all",children:[e.jsx(be,{className:"w-4 h-4 mr-2"})," Journey"]}),e.jsxs($,{value:"topics",className:"data-[state=active]:bg-white data-[state=active]:dark:bg-midnight/80 data-[state=active]:shadow-sm rounded-t-lg rounded-b-none border-b-2 border-transparent data-[state=active]:border-primary px-6 py-3 text-sm font-medium transition-all",children:[e.jsx(he,{className:"w-4 h-4 mr-2"})," Topics"]}),e.jsxs($,{value:"network",className:"data-[state=active]:bg-white data-[state=active]:dark:bg-midnight/80 data-[state=active]:shadow-sm rounded-t-lg rounded-b-none border-b-2 border-transparent data-[state=active]:border-accent px-6 py-3 text-sm font-medium transition-all",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"})," Network"]}),e.jsxs($,{value:"venues",className:"data-[state=active]:bg-white data-[state=active]:dark:bg-midnight/80 data-[state=active]:shadow-sm rounded-t-lg rounded-b-none border-b-2 border-transparent data-[state=active]:border-sage px-6 py-3 text-sm font-medium transition-all",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"})," Venues"]})]})}),e.jsxs("div",{className:"p-4 sm:p-6 md:p-8 min-h-[400px]",children:[e.jsx(U,{value:"trajectory",className:"mt-0 focus-visible:outline-none",children:e.jsx(Yt,{openalexId:a,researcherData:o,inline:!0})}),e.jsx(U,{value:"topics",className:"mt-0 focus-visible:outline-none",children:e.jsx(st,{openalexId:a,inline:!0})}),e.jsx(U,{value:"network",className:"mt-0 focus-visible:outline-none",children:e.jsx(qt,{publications:(o==null?void 0:o.publications)||[],researcherName:r})}),e.jsx(U,{value:"venues",className:"mt-0 focus-visible:outline-none",children:e.jsx(Bt,{publications:(o==null?void 0:o.publications)||[]})})]})]})})]})})}var H="Popover",[Pe,Ms]=Be(H,[ce]),z=ce(),[Vt,T]=Pe(H),Se=a=>{const{__scopePopover:o,children:r,open:t,defaultOpen:m,onOpenChange:l,modal:n=!1}=a,d=z(o),s=h.useRef(null),[i,p]=h.useState(!1),[P=!1,N]=He({prop:t,defaultProp:m,onChange:l});return e.jsx(Qe,{...d,children:e.jsx(Vt,{scope:o,contentId:Nt(),triggerRef:s,open:P,onOpenChange:N,onOpenToggle:h.useCallback(()=>N(u=>!u),[N]),hasCustomAnchor:i,onCustomAnchorAdd:h.useCallback(()=>p(!0),[]),onCustomAnchorRemove:h.useCallback(()=>p(!1),[]),modal:n,children:r})})};Se.displayName=H;var Re="PopoverAnchor",Gt=h.forwardRef((a,o)=>{const{__scopePopover:r,...t}=a,m=T(Re,r),l=z(r),{onCustomAnchorAdd:n,onCustomAnchorRemove:d}=m;return h.useEffect(()=>(n(),()=>d()),[n,d]),e.jsx(de,{...l,...t,ref:o})});Gt.displayName=Re;var _e="PopoverTrigger",Ae=h.forwardRef((a,o)=>{const{__scopePopover:r,...t}=a,m=T(_e,r),l=z(r),n=me(o,m.triggerRef),d=e.jsx(ue.button,{type:"button","aria-haspopup":"dialog","aria-expanded":m.open,"aria-controls":m.contentId,"data-state":Fe(m.open),...t,ref:n,onClick:M(a.onClick,m.onOpenToggle)});return m.hasCustomAnchor?d:e.jsx(de,{asChild:!0,...l,children:d})});Ae.displayName=_e;var Q="PopoverPortal",[Dt,Kt]=Pe(Q,{forceMount:void 0}),Te=a=>{const{__scopePopover:o,forceMount:r,children:t,container:m}=a,l=T(Q,o);return e.jsx(Dt,{scope:o,forceMount:r,children:e.jsx(xe,{present:r||l.open,children:e.jsx(De,{asChild:!0,container:m,children:t})})})};Te.displayName=Q;var F="PopoverContent",Oe=h.forwardRef((a,o)=>{const r=Kt(F,a.__scopePopover),{forceMount:t=r.forceMount,...m}=a,l=T(F,a.__scopePopover);return e.jsx(xe,{present:t||l.open,children:l.modal?e.jsx(Qt,{...m,ref:o}):e.jsx(Xt,{...m,ref:o})})});Oe.displayName=F;var Ht=Ke("PopoverContent.RemoveScroll"),Qt=h.forwardRef((a,o)=>{const r=T(F,a.__scopePopover),t=h.useRef(null),m=me(o,t),l=h.useRef(!1);return h.useEffect(()=>{const n=t.current;if(n)return jt(n)},[]),e.jsx(vt,{as:Ht,allowPinchZoom:!0,children:e.jsx(Ee,{...a,ref:m,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:M(a.onCloseAutoFocus,n=>{var d;n.preventDefault(),l.current||(d=r.triggerRef.current)==null||d.focus()}),onPointerDownOutside:M(a.onPointerDownOutside,n=>{const d=n.detail.originalEvent,s=d.button===0&&d.ctrlKey===!0,i=d.button===2||s;l.current=i},{checkForDefaultPrevented:!1}),onFocusOutside:M(a.onFocusOutside,n=>n.preventDefault(),{checkForDefaultPrevented:!1})})})}),Xt=h.forwardRef((a,o)=>{const r=T(F,a.__scopePopover),t=h.useRef(!1),m=h.useRef(!1);return e.jsx(Ee,{...a,ref:o,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{var n,d;(n=a.onCloseAutoFocus)==null||n.call(a,l),l.defaultPrevented||(t.current||(d=r.triggerRef.current)==null||d.focus(),l.preventDefault()),t.current=!1,m.current=!1},onInteractOutside:l=>{var s,i;(s=a.onInteractOutside)==null||s.call(a,l),l.defaultPrevented||(t.current=!0,l.detail.originalEvent.type==="pointerdown"&&(m.current=!0));const n=l.target;((i=r.triggerRef.current)==null?void 0:i.contains(n))&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&m.current&&l.preventDefault()}})}),Ee=h.forwardRef((a,o)=>{const{__scopePopover:r,trapFocus:t,onOpenAutoFocus:m,onCloseAutoFocus:l,disableOutsidePointerEvents:n,onEscapeKeyDown:d,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:p,...P}=a,N=T(F,r),u=z(r);return yt(),e.jsx(wt,{asChild:!0,loop:!0,trapped:t,onMountAutoFocus:m,onUnmountAutoFocus:l,children:e.jsx(We,{asChild:!0,disableOutsidePointerEvents:n,onInteractOutside:p,onEscapeKeyDown:d,onPointerDownOutside:s,onFocusOutside:i,onDismiss:()=>N.onOpenChange(!1),children:e.jsx(Ve,{"data-state":Fe(N.open),role:"dialog",id:N.contentId,...u,...P,ref:o,style:{...P.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Ie="PopoverClose",Jt=h.forwardRef((a,o)=>{const{__scopePopover:r,...t}=a,m=T(Ie,r);return e.jsx(ue.button,{type:"button",...t,ref:o,onClick:M(a.onClick,()=>m.onOpenChange(!1))})});Jt.displayName=Ie;var Zt="PopoverArrow",es=h.forwardRef((a,o)=>{const{__scopePopover:r,...t}=a,m=z(r);return e.jsx(Ge,{...m,...t,ref:o})});es.displayName=Zt;function Fe(a){return a?"open":"closed"}var ts=Se,ss=Ae,as=Te,Le=Oe;const rs=ts,is=ss,Me=h.forwardRef(({className:a,align:o="center",sideOffset:r=4,...t},m)=>e.jsx(as,{children:e.jsx(Le,{ref:m,align:o,sideOffset:r,className:Xe("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]",a),...t})}));Me.displayName=Le.displayName;function ns({isPreview:a=!1}){const{themes:o,currentTheme:r,setCurrentTheme:t,isLoading:m}=we();return m||o.length===0?null:e.jsx("div",{className:`fixed ${a?"bottom-36 md:bottom-6":"bottom-20 md:bottom-6"} right-4 md:right-6 z-40`,children:e.jsxs(rs,{children:[e.jsx(is,{asChild:!0,children:e.jsx(q,{size:"lg",className:"rounded-full shadow-lg hover:shadow-xl transition-all duration-300 h-14 w-14",style:{backgroundColor:Ne(r==null?void 0:r.config).colors.primary},"data-testid":"button-theme-switcher",children:e.jsx(re,{className:"h-6 w-6 text-white"})})}),e.jsx(Me,{className:"w-72 p-4",side:"top",align:"end",sideOffset:12,children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 pb-2 border-b",children:[e.jsx(re,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Choose Theme"})]}),e.jsx("div",{className:"grid gap-2",children:o.map(l=>e.jsx(os,{theme:l,isSelected:(r==null?void 0:r.id)===l.id,onSelect:()=>t(l)},l.id))}),a&&e.jsx("p",{className:"text-xs text-muted-foreground pt-2 border-t",children:"Preview different themes. Your preference will be saved when you sign up."})]})})]})})}function os({theme:a,isSelected:o,onSelect:r}){const t=Ne(a.config);return e.jsxs("button",{onClick:r,className:`
        w-full flex items-center gap-3 p-3 rounded-lg border transition-all duration-200
        ${o?"border-primary bg-primary/5 ring-1 ring-primary":"border-border hover:border-primary/50 hover:bg-muted/50"}
      `,"data-testid":`button-theme-${a.name.toLowerCase().replace(/\s+/g,"-")}`,children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-5 h-5 rounded-full border border-white/20",style:{backgroundColor:t.colors.primary}}),e.jsx("div",{className:"w-5 h-5 rounded-full border border-white/20 -ml-2",style:{backgroundColor:t.colors.accent}})]}),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:a.name}),a.description&&e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:a.description})]}),o&&e.jsx(Je,{className:"h-4 w-4 text-primary shrink-0"})]})}function ls({openalexId:a,name:o,title:r,institution:t,publicationCount:m,citationCount:l,profileUrl:n}){const[d,s]=h.useState(!1),[i,p]=h.useState(!1),P=h.useRef(null),{toast:N}=Ze(),u=`/api/researcher/${a}/qr-code?url=${encodeURIComponent(n||window.location.href)}`,b=async()=>{p(!0);try{const v=document.createElement("canvas"),c=v.getContext("2d");if(!c)throw new Error("Canvas not supported");const g=400,j=500;v.width=g,v.height=j,c.fillStyle="#0B1F3A",c.fillRect(0,0,g,j),c.fillStyle="rgba(255, 255, 255, 0.05)",c.beginPath(),c.arc(g+50,-50,200,0,Math.PI*2),c.fill(),c.beginPath(),c.arc(-50,j+50,150,0,Math.PI*2),c.fill(),c.fillStyle="#FFFFFF",c.font="bold 24px Inter, system-ui, sans-serif",c.textAlign="center";const A=o.length>25?o.substring(0,22)+"...":o;if(c.fillText(A,g/2,50),r){c.font="14px Inter, system-ui, sans-serif",c.fillStyle="rgba(255, 255, 255, 0.8)";const x=r.length>35?r.substring(0,32)+"...":r;c.fillText(x,g/2,75)}if(t){c.font="12px Inter, system-ui, sans-serif",c.fillStyle="rgba(255, 255, 255, 0.6)";const x=t.length>40?t.substring(0,37)+"...":t;c.fillText(x,g/2,95)}const C=new Image;C.crossOrigin="anonymous",await new Promise((x,w)=>{C.onload=()=>{const O=(g-150)/2,L=120;c.fillStyle="#FFFFFF",c.beginPath(),c.roundRect(O-10,L-10,170,170,12),c.fill(),c.drawImage(C,O,L,150,150),x()},C.onerror=w,C.src=u});const y=310;c.fillStyle="rgba(255, 255, 255, 0.1)",c.beginPath(),c.roundRect(30,y,160,70,8),c.fill(),c.beginPath(),c.roundRect(210,y,160,70,8),c.fill(),c.textAlign="center",c.fillStyle="#F2994A",c.font="bold 28px Inter, system-ui, sans-serif",c.fillText(m.toLocaleString(),110,y+35),c.fillText(l.toLocaleString(),290,y+35),c.fillStyle="rgba(255, 255, 255, 0.7)",c.font="11px Inter, system-ui, sans-serif",c.fillText("Publications",110,y+55),c.fillText("Citations",290,y+55),c.fillStyle="rgba(255, 255, 255, 0.5)",c.font="11px Inter, system-ui, sans-serif",c.fillText("Scan to view full research profile",g/2,420),c.fillStyle="rgba(255, 255, 255, 0.3)",c.font="10px Inter, system-ui, sans-serif",c.fillText("scholar.name",g/2,j-20);const R=v.toDataURL("image/png"),f=document.createElement("a");f.download=`${o.replace(/\s+/g,"-").toLowerCase()}-research-passport.png`,f.href=R,f.click(),N({title:"Download complete",description:"Your Research Passport has been saved"})}catch(v){console.error("Download error:",v),N({title:"Download failed",description:"Please try again",variant:"destructive"})}finally{p(!1)}};return e.jsxs(Pt,{open:d,onOpenChange:s,children:[e.jsx(St,{asChild:!0,children:e.jsxs("button",{className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-white shadow-sm border border-platinum hover:-translate-y-0.5 hover:shadow-md text-midnight text-sm font-medium transition-all","data-testid":"button-research-passport",children:[e.jsx(te,{className:"w-4 h-4 text-warm"}),"Passport"]})}),e.jsxs(Rt,{className:"sm:max-w-md",children:[e.jsx(_t,{children:e.jsxs(At,{className:"flex items-center gap-2",children:[e.jsx(te,{className:"h-5 w-5"}),"Research Passport"]})}),e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsxs("div",{ref:P,className:"w-full max-w-[320px] rounded-xl overflow-hidden shadow-2xl",style:{background:"linear-gradient(135deg, #0B1F3A 0%, #1a365d 100%)"},children:[e.jsxs("div",{className:"p-6 text-center text-white",children:[e.jsx("h3",{className:"text-xl font-bold mb-1 truncate",children:o}),r&&e.jsx("p",{className:"text-sm text-white/80 mb-1 truncate",children:r}),t&&e.jsx("p",{className:"text-xs text-white/60 truncate",children:t})]}),e.jsx("div",{className:"flex justify-center pb-4",children:e.jsx("div",{className:"bg-white p-3 rounded-xl",children:e.jsx("img",{src:u,alt:"QR Code",className:"w-32 h-32",loading:"lazy","data-testid":"img-passport-qr"})})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 px-6 pb-4",children:[e.jsxs("div",{className:"bg-white/10 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:e.jsx(Y,{className:"w-3 h-3 text-amber-400"})}),e.jsx("p",{className:"text-2xl font-bold text-amber-400",children:m.toLocaleString()}),e.jsx("p",{className:"text-xs text-white/70",children:"Publications"})]}),e.jsxs("div",{className:"bg-white/10 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"flex items-center justify-center gap-1 mb-1",children:e.jsx(at,{className:"w-3 h-3 text-amber-400"})}),e.jsx("p",{className:"text-2xl font-bold text-amber-400",children:l.toLocaleString()}),e.jsx("p",{className:"text-xs text-white/70",children:"Citations"})]})]}),e.jsx("div",{className:"text-center pb-4",children:e.jsx("p",{className:"text-xs text-white/50",children:"Scan to view full profile"})}),e.jsx("div",{className:"bg-white/5 py-2 text-center",children:e.jsx("p",{className:"text-xs text-white/40",children:"scholar.name"})})]}),e.jsxs(q,{onClick:b,disabled:i,className:"w-full max-w-[320px] gap-2","data-testid":"button-download-passport",children:[e.jsx(G,{className:"h-4 w-4"}),i?"Generating...":"Download Passport"]}),e.jsx("p",{className:"text-xs text-muted-foreground text-center max-w-[280px]",children:"Use this card at conferences, on business cards, or in email signatures. Scan the QR code to view the full research profile."})]})]})]})}function cs(){var d;const a=h.useRef(null),o=h.useRef(null),r=h.useRef(0),t=5,m=1e3,l=()=>{var s;if(((s=a.current)==null?void 0:s.readyState)!==EventSource.OPEN){console.log("Establishing SSE connection for real-time updates...");try{a.current=new EventSource("/api/events"),a.current.onopen=()=>{console.log("‚úÖ Real-time updates connected"),r.current=0},a.current.onmessage=i=>{try{const p=JSON.parse(i.data);"openalexId"in p?(console.log(`üîÑ Received ${p.updateType} update for researcher:`,p.openalexId),Z.invalidateQueries({queryKey:[`/api/researcher/${p.openalexId}/data`]}),Z.invalidateQueries({queryKey:["/api/researcher",p.openalexId]}),console.log(`‚ú® Frontend data refreshed for researcher: ${p.openalexId}`)):p.type==="connected"?console.log("üì° SSE connection established"):p.type}catch(p){console.error("Error parsing SSE message:",p)}},a.current.onerror=i=>{if(console.warn("‚ùå SSE connection error:",i),a.current&&(a.current.close(),a.current=null),r.current<t){const p=m*Math.pow(2,r.current);console.log(`üîÑ Reconnecting in ${p}ms (attempt ${r.current+1}/${t})`),o.current=setTimeout(()=>{r.current++,l()},p)}else console.error("üö´ Max reconnection attempts reached. Real-time updates disabled.")}}catch(i){console.error("Failed to establish SSE connection:",i)}}},n=()=>{o.current&&(clearTimeout(o.current),o.current=null),a.current&&(console.log("üîå Disconnecting real-time updates..."),a.current.close(),a.current=null)};return h.useEffect(()=>(l(),()=>{n()}),[]),{isConnected:((d=a.current)==null?void 0:d.readyState)===EventSource.OPEN,reconnect:()=>{n(),r.current=0,l()},disconnect:n}}const ne=async(a,o,r)=>{try{let t=localStorage.getItem("scholar_visitor_id");t||(t=crypto.randomUUID(),localStorage.setItem("scholar_visitor_id",t)),await fetch("/api/analytics/track",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({openalexId:a,eventType:o,eventTarget:r,visitorId:t,referrer:document.referrer||null})})}catch(t){console.debug("Analytics tracking failed:",t)}};function ds(a){if(!a)return"?";const o=a.split(" ").filter(Boolean);return o.length===1?o[0].charAt(0).toUpperCase():(o[0].charAt(0)+o[o.length-1].charAt(0)).toUpperCase()}function ms(){var c,g,j,A,C,y,R,f;const{id:a}=pe(),[,o]=et(),{themeConfig:r}=we();cs();const{data:t,isLoading:m,error:l}=oe({queryKey:[`/api/researcher/${a}/data`],retry:!1}),n=((c=t==null?void 0:t.profile)==null?void 0:c.openalexId)||a;h.useEffect(()=>{n&&!(t!=null&&t.isPreview)&&ne(n,"view")},[n,t==null?void 0:t.isPreview]);const d=h.useCallback((x,w)=>{n&&!(t!=null&&t.isPreview)&&ne(n,"click",x),w&&window.open(w,"_blank","noopener,noreferrer")},[n,t==null?void 0:t.isPreview]),s=t==null?void 0:t.profile,i=t==null?void 0:t.researcher,p=(s==null?void 0:s.openalexId)||a||"",P=s?`${s.displayName||(i==null?void 0:i.display_name)} - Research Profile`:"Research Profile",N=(s==null?void 0:s.bio)||(i?`${(s==null?void 0:s.displayName)||i.display_name} - ${(i==null?void 0:i.works_count)||0} publications, ${(i==null?void 0:i.cited_by_count)||0} citations, h-index: ${((g=i==null?void 0:i.summary_stats)==null?void 0:g.h_index)||0}`:"Research Profile Platform"),u=typeof window<"u"?window.location.href:"",b=(s==null?void 0:s.profileImageUrl)||"https://images.unsplash.com/photo-1582750433449-648ed127bb54?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&h=500",v=h.useMemo(()=>{var x,w;return s?{"@context":"https://schema.org","@type":"Person",name:s.displayName||(i==null?void 0:i.display_name),description:s.bio||`Researcher with ${(i==null?void 0:i.works_count)||0} publications`,jobTitle:s.title,affiliation:s.currentAffiliation?{"@type":"Organization",name:s.currentAffiliation}:void 0,url:u,image:b,email:s.contactEmail||void 0,alumniOf:(x=t==null?void 0:t.affiliations)==null?void 0:x.map(k=>({"@type":"Organization",name:k.institutionName})),knowsAbout:(w=t==null?void 0:t.topics)==null?void 0:w.slice(0,10).map(k=>k.displayName),sameAs:[`https://openalex.org/authors/${p}`,s.cvUrl].filter(Boolean)}:null},[s,i,t,u,b,p]);return m?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(W,{researcherName:"Loading..."}),e.jsxs("section",{className:"hero-banner min-h-[85vh] flex items-center relative",children:[e.jsx("div",{className:"hero-pattern"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-20 z-10",children:e.jsxs("div",{className:"lg:grid lg:grid-cols-12 lg:gap-12 items-center",children:[e.jsx("div",{className:"lg:col-span-4 flex justify-center lg:justify-start mb-12 lg:mb-0",children:e.jsxs("div",{className:"profile-image-container",children:[e.jsx("div",{className:"profile-image-glow"}),e.jsx("div",{className:"relative bg-white/10 backdrop-blur-sm rounded-full p-3 shadow-2xl",children:e.jsx("div",{className:"w-44 h-44 lg:w-56 lg:h-56 rounded-full border-4 border-white/30 shadow-2xl flex items-center justify-center bg-primary/20 animate-pulse",children:e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/20"})})})]})}),e.jsxs("div",{className:"lg:col-span-8 text-center lg:text-left text-white space-y-8",children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("div",{className:"h-16 lg:h-20 bg-white/20 rounded-lg mb-4 animate-pulse w-3/4 mx-auto lg:mx-0"}),e.jsx("div",{className:"h-8 bg-white/15 rounded-lg mb-4 animate-pulse w-1/2 mx-auto lg:mx-0"}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center lg:justify-start gap-4",children:[e.jsx("div",{className:"h-6 bg-white/10 rounded-lg animate-pulse w-48"}),e.jsx("div",{className:"h-6 bg-white/10 rounded-lg animate-pulse w-24"})]})]})}),e.jsx("div",{className:"bg-white/5 backdrop-blur-sm rounded-2xl p-6 border border-white/10",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-4 bg-white/15 rounded animate-pulse w-full"}),e.jsx("div",{className:"h-4 bg-white/15 rounded animate-pulse w-5/6"}),e.jsx("div",{className:"h-4 bg-white/15 rounded animate-pulse w-4/6"})]})}),e.jsxs("div",{className:"flex flex-wrap justify-center lg:justify-start gap-4 pt-4",children:[e.jsx("div",{className:"h-14 bg-white/15 rounded-xl animate-pulse w-44"}),e.jsx("div",{className:"h-14 bg-white/20 rounded-xl animate-pulse w-48"}),e.jsx("div",{className:"h-14 bg-white/10 rounded-xl animate-pulse w-40"})]}),e.jsxs("div",{className:"flex items-center justify-center lg:justify-start gap-3 pt-4",children:[e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"0ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"150ms"}}),e.jsx("div",{className:"w-2 h-2 rounded-full bg-white/60 animate-bounce",style:{animationDelay:"300ms"}})]}),e.jsx("p",{className:"text-white/70 text-sm font-medium",children:"Building your portfolio preview..."})]})]})]})})]}),e.jsx("section",{className:"py-16 bg-muted/30",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(x=>e.jsxs("div",{className:"bg-card rounded-xl p-6 shadow-sm border animate-pulse",children:[e.jsx("div",{className:"h-10 bg-muted rounded mb-2 w-16"}),e.jsx("div",{className:"h-4 bg-muted/60 rounded w-24"})]},x))})})})]}):l||!t||!t.profile?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(W,{researcherName:"Researcher Profile"}),e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-20",children:e.jsx(fe,{icon:Ft,title:"No Profile Available",description:"The researcher profile you're looking for doesn't exist or isn't public yet."})})]}):e.jsxs("div",{className:"min-h-screen bg-background pb-20 md:pb-0","data-testid":"page-researcher-profile",style:Ct(r),children:[e.jsx(tt,{title:P,description:N,image:b,url:u,author:(s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"Researcher",type:"profile",structuredData:v||void 0}),e.jsx(W,{researcherName:(s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"Researcher"}),e.jsxs("section",{id:"overview",className:"relative pb-10 scroll-mt-20",children:[e.jsxs("div",{className:"h-48 md:h-64 bg-midnight w-full relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-[url('https://images.unsplash.com/photo-1541339907198-e08756dedf3f?auto=format&fit=crop&q=80')] bg-cover bg-center opacity-40 mix-blend-overlay"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-midnight/90 to-transparent"})]}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 -mt-20 md:-mt-24",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx("div",{className:"mb-5 relative",children:s!=null&&s.profileImageUrl?e.jsx("img",{src:s.profileImageUrl,alt:"Professional portrait",className:"w-32 h-32 md:w-40 md:h-40 rounded-full object-cover border-[6px] border-background shadow-xl","data-testid":"img-profile-photo"}):e.jsx("div",{className:"w-32 h-32 md:w-40 md:h-40 rounded-full border-[6px] border-background shadow-xl flex items-center justify-center bg-midnight/90 backdrop-blur-md","data-testid":"img-profile-photo",children:e.jsx("span",{className:"text-4xl sm:text-5xl font-serif font-bold text-white",children:ds((s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"")})})}),e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-serif font-bold text-midnight dark:text-white mb-2","data-testid":"text-display-name",children:(s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"Researcher Profile"}),e.jsx("p",{className:"text-base sm:text-lg font-medium text-muted-foreground mb-2","data-testid":"text-title",children:t!=null&&t.isPreview&&!(s!=null&&s.title)?e.jsx("span",{className:"italic opacity-70",children:"Professor of [Your Field]"}):(s==null?void 0:s.title)||"Research Professional"}),((s==null?void 0:s.currentAffiliation)||((A=(j=i==null?void 0:i.last_known_institutions)==null?void 0:j[0])==null?void 0:A.display_name)||(t==null?void 0:t.isPreview))&&e.jsxs("p",{className:"text-sm font-medium text-midnight/70 dark:text-platinum flex items-center gap-1.5 mb-6","data-testid":"text-affiliation",children:[e.jsx(Tt,{className:"w-4 h-4 text-warm"}),t!=null&&t.isPreview&&!(s!=null&&s.currentAffiliation)?e.jsx("span",{className:"italic",children:"Your Institution"}):(s==null?void 0:s.currentAffiliation)||((y=(C=i==null?void 0:i.last_known_institutions)==null?void 0:C[0])==null?void 0:y.display_name)||""]}),(s==null?void 0:s.bio)&&e.jsx("p",{className:"text-base text-midnight/80 dark:text-white/80 max-w-2xl leading-relaxed mb-6 line-clamp-2",children:s.bio}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[(s==null?void 0:s.orcidUrl)&&e.jsx("a",{href:s.orcidUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2.5 rounded-full bg-white dark:bg-midnight/50 shadow-sm border border-platinum dark:border-white/10 hover:-translate-y-1 hover:shadow-md transition-all text-midnight dark:text-white",title:"ORCID",children:e.jsx(rt,{className:"w-5 h-5"})}),(s==null?void 0:s.googleScholarUrl)&&e.jsx("a",{href:s.googleScholarUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2.5 rounded-full bg-white dark:bg-midnight/50 shadow-sm border border-platinum dark:border-white/10 hover:-translate-y-1 hover:shadow-md transition-all text-midnight dark:text-white",title:"Google Scholar",children:e.jsx(it,{className:"w-5 h-5"})}),(s==null?void 0:s.linkedinUrl)&&e.jsx("a",{href:s.linkedinUrl,target:"_blank",rel:"noopener noreferrer",className:"p-2.5 rounded-full bg-white dark:bg-midnight/50 shadow-sm border border-platinum dark:border-white/10 hover:-translate-y-1 hover:shadow-md transition-all text-midnight dark:text-white",title:"LinkedIn",children:e.jsx(nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-4",children:[s!=null&&s.cvUrl&&s.cvUrl!=="#cv-placeholder"?e.jsxs("a",{href:s.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-midnight text-white font-semibold text-sm hover:bg-midnight/90 hover:-translate-y-0.5 shadow-lg hover:shadow-xl transition-all",onClick:()=>d("cv_download"),"data-testid":"link-cv",children:[e.jsx(G,{className:"w-4 h-4"}),"Download CV"]}):e.jsxs("span",{className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-muted text-muted-foreground text-sm font-medium opacity-50 cursor-not-allowed",title:"CV available after claiming profile",children:[e.jsx(G,{className:"w-4 h-4"}),"Download CV"]}),e.jsxs("a",{href:`https://openalex.org/authors/${p}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-2 px-6 py-3 rounded-xl bg-white shadow-sm border border-platinum hover:-translate-y-0.5 hover:shadow-md text-midnight text-sm font-medium transition-all",onClick:()=>d("openalex_profile"),children:[e.jsx(Ot,{className:"w-4 h-4 text-warm"}),"OpenAlex Profile"]}),e.jsx(ls,{openalexId:p,name:(s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"Researcher",title:s==null?void 0:s.title,institution:(s==null?void 0:s.currentAffiliation)||((f=(R=i==null?void 0:i.last_known_institutions)==null?void 0:R[0])==null?void 0:f.display_name),publicationCount:(i==null?void 0:i.works_count)||0,citationCount:(i==null?void 0:i.cited_by_count)||0,profileUrl:typeof window<"u"?window.location.href:""})]})]})})]}),e.jsx(ot,{openalexId:p}),((t==null?void 0:t.isPreview)||(s==null?void 0:s.bio))&&e.jsx("section",{className:"py-8 md:py-12",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsx(ee,{id:"about",title:"About",icon:e.jsx(Et,{className:"w-5 h-5 md:w-6 md:h-6"}),defaultOpen:!0,mobileDefaultOpen:!0,children:e.jsx("div",{className:"space-y-4",children:e.jsx("p",{className:"text-sm md:text-base text-muted-foreground leading-relaxed","data-testid":"text-bio",children:s!=null&&s.bio?s.bio:e.jsx("span",{className:"italic opacity-70",children:"Share your research journey, expertise, and what drives your work. Highlight your key contributions and areas of specialization to help collaborators and students discover your profile."})})})})})}),(t==null?void 0:t.profileSections)&&t.profileSections.length>0&&e.jsx($t,{sections:t.profileSections}),e.jsx(Wt,{openalexId:p,researcherData:t,researcherName:(s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"Researcher"}),e.jsx(ee,{id:"publications",title:"Publications",icon:e.jsx(le,{className:"w-5 h-5 md:w-6 md:h-6"}),defaultOpen:!0,mobileDefaultOpen:!1,className:"bg-background",children:e.jsx(lt,{openalexId:p,inline:!0})}),e.jsx("footer",{className:"bg-muted/30 border-t border-border py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[e.jsxs("p",{className:"text-muted-foreground/70 text-sm",children:["¬© ",new Date().getFullYear()," Scholar.name. All rights reserved."]}),(t==null?void 0:t.lastSynced)&&e.jsxs("p",{className:"text-xs text-muted-foreground/60",children:["Last data sync: ",new Date(t.lastSynced).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})]})]})})}),(t==null?void 0:t.isPreview)&&e.jsx("div",{className:"fixed bottom-0 left-0 right-0 z-50 bg-primary shadow-lg border-t border-primary/20 md:block hidden","data-testid":"banner-claim-profile",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-pulse"}),e.jsxs("p",{className:"text-white text-sm md:text-base font-medium",children:[e.jsx("span",{className:"hidden lg:inline",children:"This is a preview of what your profile could look like."}),e.jsx("span",{className:"lg:hidden",children:"Preview mode"})," ","Create yours at ",e.jsxs("span",{className:"font-semibold",children:[((s==null?void 0:s.displayName)||(i==null?void 0:i.display_name)||"yourname").toLowerCase().replace(/\s+/g,""),".scholar.name"]})]})]}),e.jsx(q,{onClick:()=>o("/signup"),className:"bg-white text-primary hover:bg-white/90 font-semibold px-6 py-2 rounded-lg shadow-md hover:shadow-lg transition-all","data-testid":"button-claim-profile",children:"Claim This Profile"})]})})}),(t==null?void 0:t.isPreview)&&e.jsx("div",{className:"fixed bottom-[72px] left-0 right-0 z-40 bg-primary shadow-lg border-t border-primary/20 md:hidden","data-testid":"banner-claim-profile-mobile",style:{paddingBottom:"0"},children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex flex-col gap-2 text-center",children:[e.jsx("p",{className:"text-white text-sm font-medium",children:"Like what you see? Create your own portfolio!"}),e.jsx(q,{onClick:()=>o("/signup"),className:"bg-white text-primary hover:bg-white/90 font-semibold px-6 py-2 rounded-lg shadow-md w-full","data-testid":"button-claim-profile-mobile",children:"Claim & Customize"})]})})}),e.jsx(ct,{}),e.jsx(ns,{isPreview:t==null?void 0:t.isPreview})]})}function zs(){return pe(),e.jsx(kt,{initialThemeId:null,children:e.jsx(ms,{})})}export{zs as default};
