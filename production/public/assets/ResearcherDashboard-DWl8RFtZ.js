import{u as U,b as u,j as e}from"./vendor-query-CD7Z7DR7.js";import{r as l}from"./vendor-react-DHpf67ko.js";import{c as M,i as js,j as fs,p as z,r as ue,B as d,C as h,l as j,m as f,a1 as ys,n as y,k as x,I as p,t as bs,q as I,R as pe,F as A,v as Ns,V as Be,s as vs,W as N,Q as g}from"./index-DZiZVccx.js";import{T as We}from"./textarea-CVCSZ64D.js";import{T as ws,a as Cs,b as _,c as G,Q as Ps}from"./tabs-DGXGWdYr.js";import{S as te}from"./skeleton-4y7bkwWz.js";import{S as ae}from"./separator-B0-4lERc.js";import{L as o}from"./label-DGI15HAV.js";import{E as $}from"./external-link-CMU8j9W2.js";import{L as Ss,C as ks,S as Fs}from"./settings-B42OjzZc.js";import{C as Xe}from"./circle-check-big-Duw81hgc.js";import{A as Us}from"./award-8hMgQ4xv.js";import{U as Je}from"./user-QPptfiP4.js";import{S as Ze}from"./save-Za6-Z3iV.js";import{S as es}from"./star-DgC3craP.js";import{T as ge}from"./trash-2-BVa87uvJ.js";import{P as As}from"./plus-BtJgLfQK.js";import{E as re,a as ie}from"./eye-BKgpWMsN.js";import{C as Ts}from"./circle-x-B_ba-ak1.js";import{C as ss}from"./clock-b01o5jET.js";import{P as Es}from"./palette-C68rO1jd.js";import{D as Is}from"./download-D_FzyYcE.js";import"./vendor-charts-4dyn6-nb.js";import"./index-KegacWHq.js";import"./index-nWcA1dax.js";import"./index-B1CoDt99.js";/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=M("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=M("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=M("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=M("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=M("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=M("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),qs={displayName:"",title:"",bio:"",websiteUrl:"",twitterUrl:"",linkedinUrl:"",googleScholarUrl:"",orcidUrl:"",researchGateUrl:""};function ht(){var Ie,$e,Me,Oe,Le,qe,Ve,Re,Qe,Ye,De,Ke,ze,_e,Ge,He;const[,ye]=js(),{toast:a}=fs(),[c,be]=l.useState(qs),v=l.useCallback((s,t)=>be(r=>({...r,[s]:t})),[]),[k,le]=l.useState(""),[Ne,ve]=l.useState(!1),[O,ts]=l.useState("profile"),ne=l.useRef(null),we=l.useRef(null),[oe,ce]=l.useState(!0),[as,de]=l.useState(null),[H,Ce]=l.useState(""),[T,Pe]=l.useState(""),[B,Se]=l.useState(""),[W,rs]=l.useState(!1),[X,is]=l.useState(!1),[me,he]=l.useState(null),[L,q]=l.useState(""),[V,R]=l.useState(""),[ke,J]=l.useState("custom"),{data:F,isLoading:ls}=U({queryKey:["/api/auth/me"]}),{data:i,isLoading:ns}=U({queryKey:["/api/researcher/my-tenant"],enabled:!!(F!=null&&F.user)}),{data:w,refetch:Fe}=U({queryKey:["/api/openalex/author",($e=(Ie=i==null?void 0:i.tenant)==null?void 0:Ie.profile)==null?void 0:$e.openalexId],enabled:!!((Oe=(Me=i==null?void 0:i.tenant)==null?void 0:Me.profile)!=null&&Oe.openalexId)}),{data:Q}=U({queryKey:["/api/themes"],enabled:O==="settings"}),{data:E}=U({queryKey:["/api/researcher/publications"],enabled:!!((qe=(Le=i==null?void 0:i.tenant)==null?void 0:Le.profile)!=null&&qe.openalexId)&&O==="publications"}),{data:Z}=U({queryKey:["/api/researcher/sections"],enabled:!!((Ve=i==null?void 0:i.tenant)!=null&&Ve.profile)&&O==="sections"}),{data:Y,refetch:Vs}=U({queryKey:["/api/researcher/sync-logs"],enabled:!!((Re=i==null?void 0:i.tenant)!=null&&Re.profile)&&O==="sync"});l.useEffect(()=>{var s;if((s=i==null?void 0:i.tenant)!=null&&s.profile){const t=i.tenant.profile;be({displayName:t.displayName||"",title:t.title||"",bio:t.bio||"",websiteUrl:t.websiteUrl||"",twitterUrl:t.twitterUrl||"",linkedinUrl:t.linkedinUrl||"",googleScholarUrl:t.googleScholarUrl||"",orcidUrl:t.orcidUrl||"",researchGateUrl:t.researchGateUrl||""}),le(t.openalexId||""),ce(t.isPublic!==!1),de(t.selectedThemeId||null)}},[i]);const os=u({mutationFn:async()=>{await N("POST","/api/auth/logout")},onSuccess:()=>{g.clear(),ye("/dashboard/login")}}),P=u({mutationFn:async s=>(await N("PATCH","/api/researcher/profile",s)).json(),onSuccess:()=>{a({title:"Saved!",description:"Your profile has been updated."}),g.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),b=u({mutationFn:async()=>(await N("POST","/api/researcher/sync")).json(),onSuccess:()=>{a({title:"Synced!",description:"Your profile data has been refreshed from OpenAlex."}),g.invalidateQueries({queryKey:["/api/researcher/my-tenant"]}),g.invalidateQueries({queryKey:["/api/researcher/publications"]}),g.invalidateQueries({queryKey:["/api/researcher/sync-logs"]}),Fe()},onError:s=>{a({title:"Sync Failed",description:s.message,variant:"destructive"})}}),D=u({mutationFn:async s=>{const t=await fetch(`https://api.openalex.org/authors/${s}`);if(!t.ok)throw new Error("Author not found in OpenAlex");return t.json()},onSuccess:async s=>{a({title:"Author Found!",description:`${s.display_name} with ${s.works_count} publications`}),await P.mutateAsync({openalexId:k}),Fe()},onError:()=>{a({title:"Not Found",description:"Could not find this author in OpenAlex. Check the ID.",variant:"destructive"})}}),K=u({mutationFn:async s=>{const t=new FormData;t.append("photo",s);const r=await fetch("/api/researcher/upload-photo",{method:"POST",body:t,credentials:"include"});if(!r.ok){const C=await r.json();throw new Error(C.message||"Failed to upload photo")}return r.json()},onSuccess:()=>{a({title:"Photo Updated!",description:"Your profile photo has been uploaded."}),g.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{a({title:"Upload Failed",description:s.message,variant:"destructive"})}}),ee=u({mutationFn:async s=>{const t=new FormData;t.append("cv",s);const r=await fetch("/api/researcher/upload-cv",{method:"POST",body:t,credentials:"include"});if(!r.ok){const C=await r.json();throw new Error(C.message||"Failed to upload CV")}return r.json()},onSuccess:()=>{a({title:"CV Uploaded!",description:"Your CV has been uploaded successfully."}),g.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{a({title:"Upload Failed",description:s.message,variant:"destructive"})}}),Ue=u({mutationFn:async()=>(await N("DELETE","/api/researcher/cv")).json(),onSuccess:()=>{a({title:"CV Removed",description:"Your CV has been removed from your profile."}),g.invalidateQueries({queryKey:["/api/researcher/my-tenant"]})},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),se=u({mutationFn:async s=>(await N("PATCH","/api/auth/password",s)).json(),onSuccess:()=>{a({title:"Password Changed!",description:"Your password has been updated successfully."}),Ce(""),Pe(""),Se("")},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),Ae=u({mutationFn:async({publicationId:s,isFeatured:t})=>(await N("PATCH",`/api/researcher/publications/${s}/feature`,{isFeatured:t})).json(),onSuccess:()=>{g.invalidateQueries({queryKey:["/api/researcher/publications"]})},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),cs=u({mutationFn:async({publicationId:s,file:t})=>{const r=new FormData;r.append("pdf",t);const C=await fetch(`/api/researcher/publications/${s}/upload-pdf`,{method:"POST",body:r,credentials:"include"});if(!C.ok)throw new Error("Upload failed");return C.json()},onSuccess:()=>{a({title:"PDF uploaded",description:"Publication PDF has been saved."}),g.invalidateQueries({queryKey:["/api/researcher/publications"]})},onError:()=>{a({title:"Error",description:"Failed to upload PDF",variant:"destructive"})}}),Te=u({mutationFn:async s=>{await N("DELETE",`/api/researcher/publications/${s}/pdf`)},onSuccess:()=>{a({title:"PDF removed",description:"Publication PDF has been deleted."}),g.invalidateQueries({queryKey:["/api/researcher/publications"]})},onError:()=>{a({title:"Error",description:"Failed to remove PDF",variant:"destructive"})}}),Ee=u({mutationFn:async s=>(await N("POST","/api/researcher/sections",s)).json(),onSuccess:()=>{a({title:"Section Created!",description:"Your new section has been added."}),g.invalidateQueries({queryKey:["/api/researcher/sections"]}),q(""),R(""),J("custom")},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),xe=u({mutationFn:async({id:s,...t})=>(await N("PATCH",`/api/researcher/sections/${s}`,t)).json(),onSuccess:()=>{a({title:"Section Updated!",description:"Your changes have been saved."}),g.invalidateQueries({queryKey:["/api/researcher/sections"]}),he(null),q(""),R("")},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),ds=u({mutationFn:async s=>(await N("DELETE",`/api/researcher/sections/${s}`)).json(),onSuccess:()=>{a({title:"Section Deleted",description:"The section has been removed."}),g.invalidateQueries({queryKey:["/api/researcher/sections"]})},onError:s=>{a({title:"Error",description:s.message,variant:"destructive"})}}),ms=l.useCallback(async()=>{ve(!0);try{await P.mutateAsync({displayName:c.displayName||null,title:c.title||null,bio:c.bio||null,websiteUrl:c.websiteUrl||null,twitterUrl:c.twitterUrl||null,linkedinUrl:c.linkedinUrl||null,googleScholarUrl:c.googleScholarUrl||null,orcidUrl:c.orcidUrl||null,researchGateUrl:c.researchGateUrl||null})}finally{ve(!1)}},[c,P]),hs=l.useCallback(s=>{var r;const t=(r=s.target.files)==null?void 0:r[0];if(t){if(t.size>5*1024*1024){a({title:"File too large",description:"Please choose an image under 5MB",variant:"destructive"});return}K.mutate(t)}},[a,K]),xs=l.useCallback(s=>{var r;const t=(r=s.target.files)==null?void 0:r[0];if(t){if(t.size>10*1024*1024){a({title:"File too large",description:"Please choose a document under 10MB",variant:"destructive"});return}ee.mutate(t)}},[a,ee]),us=l.useCallback(()=>{if(T!==B){a({title:"Passwords don't match",description:"New password and confirmation must match",variant:"destructive"});return}if(T.length<8){a({title:"Password too short",description:"Password must be at least 8 characters",variant:"destructive"});return}se.mutate({currentPassword:H,newPassword:T})},[H,T,B,a,se]),ps=l.useCallback(async s=>{ce(s);try{await P.mutateAsync({isPublic:s})}catch{ce(!s)}},[P]),gs=l.useCallback(async s=>{var t,r;de(s);try{await P.mutateAsync({selectedThemeId:s})}catch{de(((r=(t=i==null?void 0:i.tenant)==null?void 0:t.profile)==null?void 0:r.selectedThemeId)||null)}},[P,i]);if(ls||ns)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsx(te,{className:"h-20 w-full"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(te,{className:"h-32"}),e.jsx(te,{className:"h-32"}),e.jsx(te,{className:"h-32"})]})]})});if(!(F!=null&&F.user))return ye("/dashboard/login"),null;const m=i==null?void 0:i.tenant,n=m==null?void 0:m.profile,S=((Qe=m==null?void 0:m.domains)==null?void 0:Qe.find(s=>s.isPrimary))||((Ye=m==null?void 0:m.domains)==null?void 0:Ye[0]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex flex-col",children:[e.jsx("header",{className:"border-b bg-white sticky top-0 z-50",children:e.jsxs("div",{className:"max-w-5xl mx-auto px-4 py-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-primary rounded-xl flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold text-foreground",children:"My Portfolio"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Welcome, ",F.user.firstName]})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[S&&e.jsxs("a",{href:`https://${S.hostname}`,target:"_blank",rel:"noopener noreferrer",className:"hidden md:flex items-center gap-2 text-sm text-muted-foreground hover:text-foreground transition-colors",children:[e.jsx(ue,{className:"w-4 h-4"}),S.hostname,e.jsx($,{className:"w-3 h-3"})]}),e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>os.mutate(),className:"text-muted-foreground hover:text-foreground","data-testid":"button-logout",children:[e.jsx(Ss,{className:"w-4 h-4 mr-2"}),"Sign Out"]})]})]})}),e.jsxs("main",{className:"flex-1 max-w-5xl mx-auto w-full px-4 py-8 space-y-8",children:[n!=null&&n.openalexId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(h,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Publications"}),e.jsx("p",{className:"text-3xl font-bold text-foreground",children:((De=w==null?void 0:w.works_count)==null?void 0:De.toLocaleString())||"—"})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(z,{className:"w-6 h-6 text-blue-600"})})]})})}),e.jsx(h,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Citations"}),e.jsx("p",{className:"text-3xl font-bold text-foreground",children:((Ke=w==null?void 0:w.cited_by_count)==null?void 0:Ke.toLocaleString())||"—"})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(bs,{className:"w-6 h-6 text-green-600"})})]})})}),e.jsx(h,{children:e.jsx(x,{className:"pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Status"}),e.jsx("div",{className:"flex items-center gap-2 mt-1",children:(m==null?void 0:m.status)==="active"?e.jsxs(e.Fragment,{children:[e.jsx(Xe,{className:"w-5 h-5 text-green-500"}),e.jsx("span",{className:"text-lg font-medium text-green-600",children:"Live"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ks,{className:"w-5 h-5 text-yellow-500"}),e.jsx("span",{className:"text-lg font-medium text-yellow-600",children:"Pending"})]})})]}),e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(Us,{className:"w-6 h-6 text-purple-600"})})]})})})]}),e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsxs(I,{className:"bg-slate-100 text-slate-700 hover:bg-slate-100",children:["OpenAlex: ",n.openalexId]}),n.lastSyncedAt&&e.jsxs("span",{className:"text-sm text-muted-foreground",children:["Last synced:"," ",new Date(n.lastSyncedAt).toLocaleDateString()]})]}),e.jsxs(d,{variant:"outline",size:"sm",onClick:()=>b.mutate(),disabled:b.isPending,"data-testid":"button-sync",children:[e.jsx(pe,{className:`w-4 h-4 mr-2 ${b.isPending?"animate-spin":""}`}),"Refresh Data"]})]})]}):e.jsxs(h,{className:"border-orange-200 bg-orange-50",children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2 text-orange-800",children:[e.jsx(ys,{className:"w-5 h-5"}),"Connect Your OpenAlex Profile"]}),e.jsx(y,{className:"text-orange-700",children:"Enter your OpenAlex author ID to automatically import your publications, metrics, and research topics."})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(o,{htmlFor:"openalex-connect",className:"sr-only",children:"OpenAlex Author ID"}),e.jsx(p,{id:"openalex-connect",value:k,onChange:s=>le(s.target.value),placeholder:"e.g., A5023888391","data-testid":"input-openalex-id"})]}),e.jsx(d,{onClick:()=>D.mutate(k),disabled:!k||D.isPending,className:"bg-orange-500 hover:bg-orange-600","data-testid":"button-verify-openalex",children:D.isPending?"Checking...":"Connect"})]}),e.jsxs("p",{className:"text-sm text-orange-600",children:["Find your ID by searching your name on"," ",e.jsx("a",{href:"https://openalex.org/authors",target:"_blank",rel:"noopener noreferrer",className:"underline",children:"OpenAlex Authors"})]})]})]}),e.jsxs(ws,{value:O,onValueChange:ts,className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-4 px-4 sm:mx-0 sm:px-0",children:e.jsxs(Cs,{className:"inline-flex w-auto min-w-full sm:grid sm:grid-cols-5 sm:w-[650px] h-auto p-1",children:[e.jsxs(_,{value:"profile","data-testid":"tab-profile",className:"flex-shrink-0 text-xs sm:text-sm",children:[e.jsx(Je,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Profile"})]}),e.jsxs(_,{value:"publications","data-testid":"tab-publications",className:"flex-shrink-0 text-xs sm:text-sm",children:[e.jsx(z,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Publications"})]}),e.jsxs(_,{value:"sections","data-testid":"tab-sections",className:"flex-shrink-0 text-xs sm:text-sm",children:[e.jsx(A,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sections"})]}),e.jsxs(_,{value:"sync","data-testid":"tab-sync",className:"flex-shrink-0 text-xs sm:text-sm",children:[e.jsx(je,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Sync"})]}),e.jsxs(_,{value:"settings","data-testid":"tab-settings",className:"flex-shrink-0 text-xs sm:text-sm",children:[e.jsx(Fs,{className:"w-4 h-4 sm:mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"})]})]})}),e.jsxs(G,{value:"profile",className:"mt-6 space-y-6",children:[e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(f,{children:"Profile Photo"}),e.jsx(y,{children:"Upload a professional photo to personalize your portfolio"})]}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center gap-6",children:[e.jsxs("div",{className:"relative",children:[n!=null&&n.profileImageUrl?e.jsx("img",{src:n.profileImageUrl,alt:"Your profile photo",className:"w-24 h-24 rounded-full object-cover border-4 border-slate-100"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-primary flex items-center justify-center",children:e.jsx(Je,{className:"w-10 h-10 text-white"})}),e.jsx("button",{onClick:()=>{var s;return(s=ne.current)==null?void 0:s.click()},disabled:K.isPending,className:"absolute bottom-0 right-0 w-8 h-8 bg-white rounded-full shadow-lg flex items-center justify-center border border-slate-200 hover:bg-slate-50 transition-colors","aria-label":"Change profile photo","data-testid":"button-change-photo",children:e.jsx($s,{className:"w-4 h-4 text-muted-foreground"})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:ne,type:"file",accept:"image/*",onChange:hs,className:"hidden","aria-label":"Upload profile photo","data-testid":"input-photo-file"}),e.jsxs(d,{variant:"outline",onClick:()=>{var s;return(s=ne.current)==null?void 0:s.click()},disabled:K.isPending,"data-testid":"button-upload-photo",children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),K.isPending?"Uploading...":"Upload Photo"]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"JPG, PNG or GIF. Max 5MB."})]})]})})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(f,{children:"Profile Information"}),e.jsx(y,{children:"Customize how your name and biography appear on your portfolio"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"display-name",children:"Display Name"}),e.jsx(p,{id:"display-name",value:c.displayName,onChange:s=>v("displayName",s.target.value),placeholder:(w==null?void 0:w.display_name)||"Your Name","data-testid":"input-display-name"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Leave blank to use your name from OpenAlex"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"professional-title",children:"Professional Title"}),e.jsx(p,{id:"professional-title",value:c.title,onChange:s=>v("title",s.target.value),placeholder:"e.g., Associate Professor of Computer Science","data-testid":"input-title"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"biography",children:"Biography"}),e.jsx(We,{id:"biography",value:c.bio,onChange:s=>v("bio",s.target.value),placeholder:"Tell visitors about your research interests, background, and achievements...",className:"min-h-[150px]","data-testid":"input-bio"})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"w-5 h-5"}),"Social & Academic Links"]}),e.jsx(y,{children:"Add links to your other profiles and websites"})]}),e.jsx(x,{className:"space-y-4",children:e.jsxs("div",{className:"grid sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"website-url",children:"Personal Website"}),e.jsx(p,{id:"website-url",value:c.websiteUrl,onChange:s=>v("websiteUrl",s.target.value),placeholder:"https://yourwebsite.com",type:"url","data-testid":"input-website"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"twitter-url",children:"Twitter / X"}),e.jsx(p,{id:"twitter-url",value:c.twitterUrl,onChange:s=>v("twitterUrl",s.target.value),placeholder:"https://twitter.com/yourusername",type:"url","data-testid":"input-twitter"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"linkedin-url",children:"LinkedIn"}),e.jsx(p,{id:"linkedin-url",value:c.linkedinUrl,onChange:s=>v("linkedinUrl",s.target.value),placeholder:"https://linkedin.com/in/yourusername",type:"url","data-testid":"input-linkedin"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"google-scholar-url",children:"Google Scholar"}),e.jsx(p,{id:"google-scholar-url",value:c.googleScholarUrl,onChange:s=>v("googleScholarUrl",s.target.value),placeholder:"https://scholar.google.com/citations?user=...",type:"url","data-testid":"input-google-scholar"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"orcid-url",children:"ORCID"}),e.jsx(p,{id:"orcid-url",value:c.orcidUrl,onChange:s=>v("orcidUrl",s.target.value),placeholder:"https://orcid.org/0000-0000-0000-0000",type:"url","data-testid":"input-orcid"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"researchgate-url",children:"ResearchGate"}),e.jsx(p,{id:"researchgate-url",value:c.researchGateUrl,onChange:s=>v("researchGateUrl",s.target.value),placeholder:"https://www.researchgate.net/profile/Your-Name",type:"url","data-testid":"input-researchgate"})]})]})})]}),e.jsxs(d,{onClick:ms,disabled:Ne,className:"bg-primary hover:bg-primary/90","data-testid":"button-save-profile",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),Ne?"Saving...":"Save All Changes"]})]}),e.jsx(G,{value:"publications",className:"mt-6 space-y-6",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(es,{className:"w-5 h-5 text-yellow-500"}),"Featured Publications"]}),e.jsx(y,{children:"Mark publications as featured to highlight them on your portfolio. Featured publications appear prominently at the top."})]}),e.jsx(x,{children:(_e=(ze=i==null?void 0:i.tenant)==null?void 0:ze.profile)!=null&&_e.openalexId?(Ge=E==null?void 0:E.publications)!=null&&Ge.length?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground pb-2 border-b",children:[e.jsxs("span",{children:[E.publications.filter(s=>s.isFeatured).length," ","featured"]}),e.jsxs("span",{children:[E.publications.length," total publications"]})]}),e.jsx("div",{className:"max-h-[500px] overflow-y-auto space-y-2",children:E.publications.map(s=>e.jsxs("div",{className:`flex items-start gap-3 p-3 rounded-lg border transition-colors ${s.isFeatured?"bg-yellow-50 border-yellow-200":"bg-white border-slate-200 hover:border-slate-300"}`,children:[e.jsx("button",{onClick:()=>Ae.mutate({publicationId:s.id,isFeatured:!s.isFeatured}),className:`mt-1 transition-colors ${s.isFeatured?"text-yellow-500":"text-slate-300 hover:text-yellow-400"}`,disabled:Ae.isPending,"aria-pressed":s.isFeatured,"aria-label":s.isFeatured?`Unfeature "${s.title}"`:`Feature "${s.title}"`,children:e.jsx(es,{className:`w-5 h-5 ${s.isFeatured?"fill-current":""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"font-medium text-sm text-foreground line-clamp-2",children:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[s.journal&&e.jsx("span",{children:s.journal}),s.publicationYear&&e.jsxs("span",{children:[" ","· ",s.publicationYear]}),s.citationCount>0&&e.jsxs("span",{children:[" ","· ",s.citationCount," ","citations"]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2 flex-wrap",children:[s.isOpenAccess&&e.jsx(I,{variant:"outline",className:"text-green-600 border-green-300 text-xs",children:"Open Access"}),s.doi&&e.jsxs("a",{href:`https://doi.org/${s.doi}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-600 hover:underline flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),"DOI"]}),s.pdfUrl?e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsxs("a",{href:s.pdfUrl,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-green-600 hover:underline flex items-center gap-1",children:[e.jsx(A,{className:"w-3 h-3"}),"PDF"]}),e.jsx("button",{onClick:()=>Te.mutate(s.id),disabled:Te.isPending,className:"text-xs text-red-500 hover:text-red-700","aria-label":`Remove PDF for "${s.title}"`,children:e.jsx(ge,{className:"w-3 h-3"})})]}):e.jsxs("label",{className:"text-xs text-muted-foreground hover:text-blue-600 cursor-pointer flex items-center gap-1",children:[e.jsx(fe,{className:"w-3 h-3"}),"Upload PDF",e.jsx("input",{type:"file",accept:".pdf",className:"hidden","aria-label":`Upload PDF for "${s.title}"`,onChange:t=>{var C;const r=(C=t.target.files)==null?void 0:C[0];if(r){if(r.size>10*1024*1024){a({title:"File too large",description:"PDF must be under 10MB",variant:"destructive"});return}cs.mutate({publicationId:s.id,file:r}),t.target.value=""}}})]})]})]})]},s.id))})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No publications found. Try syncing your profile."}),e.jsxs(d,{onClick:()=>b.mutate(),variant:"outline",className:"mt-4",disabled:b.isPending,children:[e.jsx(pe,{className:`w-4 h-4 mr-2 ${b.isPending?"animate-spin":""}`}),"Sync Now"]})]}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(z,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"Connect your OpenAlex ID to manage publications"})]})})]})}),e.jsx(G,{value:"sections",className:"mt-6 space-y-6",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5 text-blue-500"}),"Content Sections"]}),e.jsx(y,{children:"Add custom sections to your portfolio such as Research Interests, Awards, Teaching, or any other content."})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"space-y-4 pb-6 border-b",children:[e.jsx("h4",{className:"font-medium text-sm text-foreground",children:me?"Edit Section":"Add New Section"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"section-title",children:"Section Title"}),e.jsx(p,{id:"section-title",value:L,onChange:s=>q(s.target.value),placeholder:"e.g., Research Interests, Awards, Teaching"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"section-type",children:"Section Type"}),e.jsxs("select",{id:"section-type",value:ke,onChange:s=>J(s.target.value),className:"w-full h-10 px-3 rounded-md border border-input bg-background text-sm",children:[e.jsx("option",{value:"custom",children:"Custom"}),e.jsx("option",{value:"research_interests",children:"Research Interests"}),e.jsx("option",{value:"awards",children:"Awards & Honors"}),e.jsx("option",{value:"teaching",children:"Teaching"}),e.jsx("option",{value:"grants",children:"Grants & Funding"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"section-content",children:"Content"}),e.jsx(We,{id:"section-content",value:V,onChange:s=>R(s.target.value),placeholder:"Enter your content here. You can use markdown for formatting...",className:"min-h-[120px]"})]}),e.jsx("div",{className:"flex gap-2",children:me?e.jsxs(e.Fragment,{children:[e.jsxs(d,{onClick:()=>{xe.mutate({id:me,title:L,content:V})},disabled:!L||!V||xe.isPending,className:"bg-primary hover:bg-primary/90",children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Save Changes"]}),e.jsx(d,{variant:"outline",onClick:()=>{he(null),q(""),R(""),J("custom")},children:"Cancel"})]}):e.jsxs(d,{onClick:()=>{Ee.mutate({title:L,content:V,sectionType:ke})},disabled:!L||!V||Ee.isPending,className:"bg-primary hover:bg-primary/90",children:[e.jsx(As,{className:"w-4 h-4 mr-2"}),"Add Section"]})})]}),e.jsxs("div",{className:"pt-6 space-y-3",children:[e.jsx("h4",{className:"font-medium text-sm text-foreground",children:"Your Sections"}),(He=Z==null?void 0:Z.sections)!=null&&He.length?e.jsx("div",{className:"space-y-2",children:Z.sections.map(s=>e.jsxs("div",{className:"flex items-start gap-3 p-4 rounded-lg border bg-white border-slate-200",children:[e.jsx(Os,{className:"w-4 h-4 mt-1 text-muted-foreground"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx("h5",{className:"font-medium text-foreground",children:s.title}),e.jsx(I,{variant:"outline",className:"text-xs",children:s.sectionType}),!s.isVisible&&e.jsx(I,{variant:"outline",className:"text-xs text-orange-600 border-orange-300",children:"Hidden"})]}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1 line-clamp-2",children:s.content})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(d,{variant:"ghost",size:"sm","aria-label":`Edit "${s.title}"`,onClick:()=>{he(s.id),q(s.title),R(s.content),J(s.sectionType)},children:e.jsx(Ls,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"sm","aria-label":s.isVisible?`Hide "${s.title}"`:`Show "${s.title}"`,onClick:()=>{xe.mutate({id:s.id,isVisible:!s.isVisible})},children:s.isVisible?e.jsx(re,{className:"w-4 h-4"}):e.jsx(ie,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700 hover:bg-red-50","aria-label":`Delete "${s.title}"`,onClick:()=>{confirm("Are you sure you want to delete this section?")&&ds.mutate(s.id)},children:e.jsx(ge,{className:"w-4 h-4"})})]})]},s.id))}):e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(A,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No custom sections yet. Add one above!"})]})]})]})]})}),e.jsx(G,{value:"sync",className:"mt-6 space-y-6",children:e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(je,{className:"w-5 h-5"}),"OpenAlex Sync Management"]}),e.jsx(y,{children:"View sync history and manually trigger data synchronization from OpenAlex"})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground",children:"Sync Publications"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Fetch latest publications and citations from OpenAlex"})]}),e.jsxs(d,{onClick:()=>b.mutate(),disabled:b.isPending,children:[e.jsx(pe,{className:`w-4 h-4 mr-2 ${b.isPending?"animate-spin":""}`}),b.isPending?"Syncing...":"Sync Now"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-foreground mb-4",children:"Sync History"}),!(Y!=null&&Y.logs)||Y.logs.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground bg-slate-50 rounded-lg border border-dashed",children:[e.jsx(je,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No sync history yet"}),e.jsx("p",{className:"text-sm",children:"Click “Sync Now” to fetch your latest publications"})]}):e.jsx("div",{className:"space-y-3",children:Y.logs.map(s=>e.jsxs("div",{className:`p-4 rounded-lg border ${s.status==="completed"?"bg-green-50 border-green-200":s.status==="failed"?"bg-red-50 border-red-200":s.status==="in_progress"?"bg-blue-50 border-blue-200":"bg-slate-50 border-slate-200"}`,children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s.status==="completed"&&e.jsx(Ms,{className:"w-5 h-5 text-green-600"}),s.status==="failed"&&e.jsx(Ts,{className:"w-5 h-5 text-red-600"}),s.status==="in_progress"&&e.jsx(ss,{className:"w-5 h-5 text-blue-600 animate-pulse"}),s.status==="pending"&&e.jsx(ss,{className:"w-5 h-5 text-muted-foreground"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-foreground capitalize",children:[s.syncType.replace("_"," ")," ","Sync"]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Started:"," ",new Date(s.startedAt).toLocaleString()]})]})]}),e.jsx(I,{variant:"outline",className:`${s.status==="completed"?"text-green-700 border-green-300":s.status==="failed"?"text-red-700 border-red-300":s.status==="in_progress"?"text-blue-700 border-blue-300":"text-slate-700 border-slate-300"}`,children:s.status})]}),s.itemsProcessed!==null&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Processed: ",s.itemsProcessed,s.itemsTotal?` / ${s.itemsTotal}`:""," ","items"]}),s.errorMessage&&e.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["Error: ",s.errorMessage]}),s.completedAt&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Completed:"," ",new Date(s.completedAt).toLocaleString()]})]},s.id))})]})]})]})}),e.jsxs(G,{value:"settings",className:"mt-6 space-y-6",children:[e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[oe?e.jsx(re,{className:"w-5 h-5 text-green-600"}):e.jsx(ie,{className:"w-5 h-5 text-muted-foreground"}),"Profile Visibility"]}),e.jsx(y,{children:"Control who can see your research portfolio"})]}),e.jsx(x,{children:e.jsxs("div",{className:"flex items-center justify-between p-4 bg-slate-50 rounded-lg border",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(o,{htmlFor:"profile-visibility",className:"text-base font-medium",children:"Public Profile"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:oe?"Your portfolio is visible to everyone on the internet":"Your portfolio is hidden from public view"})]}),e.jsx(Ns,{id:"profile-visibility",checked:oe,onCheckedChange:ps,disabled:P.isPending})]})})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(A,{className:"w-5 h-5"}),"CV / Resume"]}),e.jsx(y,{children:"Upload your CV to allow visitors to download it from your portfolio"})]}),e.jsx(x,{className:"space-y-4",children:n!=null&&n.cvUrl?e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsx(A,{className:"w-8 h-8 text-green-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-green-800",children:"CV Uploaded"}),e.jsx("p",{className:"text-sm text-green-600",children:"Your CV is available for download on your portfolio"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("a",{href:n.cvUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-3 py-1.5 bg-green-600 text-white rounded-md text-sm font-medium hover:bg-green-700",children:[e.jsx($,{className:"w-3 h-3"}),"View"]}),e.jsx(d,{variant:"outline",size:"sm",onClick:()=>Ue.mutate(),disabled:Ue.isPending,className:"text-red-600 hover:text-red-700 hover:bg-red-50","aria-label":"Remove CV",children:e.jsx(ge,{className:"w-4 h-4"})})]})]}):e.jsxs("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-6 text-center",children:[e.jsx(A,{className:"w-10 h-10 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-muted-foreground mb-3",children:"No CV uploaded yet"}),e.jsx("input",{ref:we,type:"file",accept:".pdf,.doc,.docx",onChange:xs,className:"hidden","aria-label":"Upload CV file"}),e.jsxs(d,{variant:"outline",onClick:()=>{var s;return(s=we.current)==null?void 0:s.click()},disabled:ee.isPending,children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),ee.isPending?"Uploading...":"Upload CV"]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"PDF, DOC, or DOCX. Max 10MB."})]})})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(Es,{className:"w-5 h-5"}),"Portfolio Theme"]}),e.jsx(y,{children:"Choose a color theme for your research portfolio"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:Q==null?void 0:Q.filter(s=>s.isActive).map(s=>{const t=s.config,r=as===s.id;return e.jsxs("button",{onClick:()=>gs(s.id),"aria-pressed":r,"aria-label":`Select ${s.name} theme`,className:`relative p-4 rounded-lg border-2 transition-all ${r?"border-primary bg-primary/5 ring-2 ring-primary/20":"border-slate-200 hover:border-slate-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("div",{className:"w-6 h-6 rounded-full border border-slate-200",style:{backgroundColor:t.colors.primary}}),e.jsx("div",{className:"w-4 h-4 rounded-full border border-slate-200",style:{backgroundColor:t.colors.accent}})]}),e.jsx("p",{className:"text-sm font-medium text-left",children:s.name}),r&&e.jsx(Xe,{className:"absolute top-2 right-2 w-5 h-5 text-primary"})]},s.id)})}),(!Q||Q.length===0)&&e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No themes available. Contact your administrator."})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsx(f,{children:"Account Settings"}),e.jsx(y,{children:"Manage your account and portfolio settings"})]}),e.jsxs(x,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Preview Portfolio"}),n!=null&&n.openalexId?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-blue-50 rounded-lg border border-blue-100",children:[e.jsx($,{className:"w-4 h-4 text-blue-500"}),e.jsx("span",{className:"text-sm text-blue-700",children:"See how visitors will view your portfolio"}),e.jsxs("a",{href:`/researcher/${n.openalexId}`,target:"_blank",rel:"noopener noreferrer",className:"ml-auto bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-blue-700 flex items-center gap-1","data-testid":"link-preview-portfolio",children:["Preview",e.jsx($,{className:"w-3 h-3"})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect your OpenAlex ID to preview your portfolio"})]}),e.jsx(ae,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"QR Code"}),n!=null&&n.openalexId?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-purple-50 rounded-lg border border-purple-100",children:[e.jsx(Ps,{className:"w-4 h-4 text-purple-500"}),e.jsx("span",{className:"text-sm text-purple-700",children:"Download a QR code linking to your portfolio"}),e.jsxs("a",{href:`/api/researcher/${n.openalexId}/qr-code${S?`?url=https://${S.hostname}`:""}`,download:`${n.displayName||"portfolio"}-qr-code.png`,className:"ml-auto bg-purple-600 text-white px-3 py-1.5 rounded-md text-sm font-medium hover:bg-purple-700 flex items-center gap-1","data-testid":"link-download-qr",children:[e.jsx(Is,{className:"w-3 h-3"}),"Download QR"]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect your OpenAlex ID to generate a QR code"})]}),e.jsx(ae,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Your Domain"}),S?e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-slate-50 rounded-lg",children:[e.jsx(ue,{className:"w-4 h-4 text-muted-foreground"}),e.jsx("span",{className:"font-medium",children:S.hostname}),e.jsxs("a",{href:`https://${S.hostname}`,target:"_blank",rel:"noopener noreferrer",className:"ml-auto text-blue-600 hover:text-blue-700 flex items-center gap-1 text-sm",children:["Visit Site",e.jsx($,{className:"w-3 h-3"})]})]}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Your domain will be assigned by the administrator"})]}),e.jsx(ae,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{children:"Plan"}),e.jsxs("div",{className:"flex items-center gap-2 p-3 bg-slate-50 rounded-lg",children:[e.jsx(I,{className:"capitalize",children:m==null?void 0:m.plan}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Contact support to change your plan"})]})]}),e.jsx(ae,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"settings-openalex-id",children:"OpenAlex ID"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{id:"settings-openalex-id",value:k,onChange:s=>le(s.target.value),placeholder:"e.g., A5023888391",className:"flex-1","data-testid":"input-change-openalex-id"}),e.jsx(d,{variant:"outline",onClick:()=>D.mutate(k),disabled:!k||D.isPending,"data-testid":"button-update-openalex",children:"Update"})]})]})]})]}),e.jsxs(h,{children:[e.jsxs(j,{children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(Be,{className:"w-5 h-5"}),"Change Password"]}),e.jsx(y,{children:"Update your account password"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"current-password",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(p,{id:"current-password",type:W?"text":"password",value:H,onChange:s=>Ce(s.target.value),placeholder:"Enter current password"}),e.jsx("button",{type:"button",onClick:()=>rs(!W),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":W?"Hide current password":"Show current password",children:W?e.jsx(ie,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"new-password",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(p,{id:"new-password",type:X?"text":"password",value:T,onChange:s=>Pe(s.target.value),placeholder:"Enter new password (min. 8 characters)"}),e.jsx("button",{type:"button",onClick:()=>is(!X),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":X?"Hide new password":"Show new password",children:X?e.jsx(ie,{className:"w-4 h-4"}):e.jsx(re,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{htmlFor:"confirm-password",children:"Confirm New Password"}),e.jsx(p,{id:"confirm-password",type:"password",value:B,onChange:s=>Se(s.target.value),placeholder:"Confirm new password"})]}),e.jsxs(d,{onClick:us,disabled:!H||!T||!B||se.isPending,className:"bg-primary hover:bg-primary/90",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),se.isPending?"Updating...":"Update Password"]})]})]})]})]})]}),e.jsx(vs,{mode:"app"})]})}export{ht as default};
